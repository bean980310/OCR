--- ABSTRACT ---
우리는 여러 에이전트에 대한 미래 궤적의 공동 분포를 위한 확산 기반 표현인 MotionDiffuser를 제시합니다. 이러한 표현에는 몇 가지 주요 이점이 있습니다. 첫째, 우리 모델은 다양한 미래 결과를 포착하는 매우 다중 모드 분포를 학습합니다. 둘째, 간단한 예측기 설계에는 단일 L2 손실 학습 목표만 필요하며 궤적 앵커에 의존하지 않습니다. 셋째, 우리 모델은 순열 불변 방식으로 여러 에이전트의 동작에 대한 공동 분포를 학습할 수 있습니다. 더욱이 우리는 PCA를 통한 압축 궤적 표현을 활용하여 모델 성능을 개선하고 정확한 샘플 로그 확률을 효율적으로 계산할 수 있습니다. 그 후, 우리는 미분 가능한 비용 함수에 기반한 제어된 궤적 샘플링을 가능하게 하는 일반적인 제약 샘플링 프레임워크를 제안합니다. 이 전략은 규칙 및 물리적 사전 적용 또는 맞춤형 시뮬레이션 시나리오 생성과 같은 많은 응용 프로그램을 가능하게 합니다. Motion Diffuser는 기존 백본 아키텍처와 결합하여 최상의 동작 예측 결과를 얻을 수 있습니다. 우리는 Waymo Open Motion Dataset에서 다중 에이전트 동작 예측에 대한 최첨단 결과를 얻습니다. 1.
--- INTRODUCTION ---
동작 예측은 자율 주행 차량이 불확실성 속에서 안전하게 주행하기 위한 핵심적이지만 어려운 문제입니다. 자율 주행 환경에서 동작 예측은 모델링된 에이전트의 미래 궤적을 모델링된 에이전트, 컨텍스트 에이전트, 도로 그래프 및 신호등 신호의 이력에 따라 예측하는 것을 말합니다. 동작 예측 문제에서 몇 가지 주요 과제가 발생합니다. 첫째, 동작 예측은 확률적이고 다중 모드적 특성을 지니며, 가능한 미래의 편향 없는 분포를 충실하게 예측하는 것이 중요합니다. 둘째, 동작 예측은 각 미래에서 서로 상호 작용할 수 있는 에이전트 집합의 미래 분포에 대해 공동으로 추론해야 합니다. 각 에이전트의 궤적의 한계 분포를 독립적으로 순진하게 예측하고 샘플링하면 비현실적이고 종종 상충되는 결과가 발생합니다. 마지막으로, 기존 회귀 기반 궤적 모델의 예측을 제한하거나 편향시키는 것은 어렵지만 궤적의 가이드 샘플링이 종종 필요합니다. 예를 들어, 맞춤형 시뮬레이션 시나리오를 만들기 위해 규칙이나 물리적 사전 확률을 적용하는 것이 유용할 수 있습니다. 이를 위해서는 미래 시간 단계에 대한 제약 조건을 적용하거나 하나 또는 GT 궤적 SS+ €~ N(0,0²1) = 노이즈가 있는 궤적 SHistory Context Agents Encoder |000= Condition Tokens C Denoiser Traffic Light Road Graph Denoiser Denoiser SScene Input S1, S2 ~N(0,0maxI) Optional Constraint x Spred Denoised Trajectory STraining Inference 그림 2. 확산 모델을 사용한 다중 에이전트 동작 예측 개요. 에이전트 기록, 신호등 및 도로 그래프가 포함된 입력 장면은 변환기 인코더를 통해 조건 토큰 C 세트로 인코딩됩니다. 학습하는 동안 정규 분포에서 무작위 노이즈 세트가 iid 샘플링되어 GT(ground truth) 궤적에 추가됩니다. 조건 토큰을 처리하는 동안 노이즈 제거기는 각 에이전트에 해당하는 노이즈가 제거된 궤적을 예측합니다. 전체 모델은 예측된 잡음 제거 궤적과 GT 궤적 사이의 간단한 L2 손실을 사용하여 종단 간 학습할 수 있습니다. 추론하는 동안 각 에이전트의 궤적 집단은 먼저 가장 높은 잡음 수준 σmax에서 순수 잡음에서 샘플링되고, 잡음 제거기에 의해 반복적으로 잡음 제거되어 미래 궤적의 그럴듯한 분포를 생성할 수 있습니다. 임의의 미분 가능 손실 함수 형태의 선택적 제약 조건을 잡음 제거 프로세스에 주입하여 제약 조건을 적용할 수 있습니다. 에이전트 집합 간에 더 많은 에이전트. 이러한 과제에 비추어, 우리는 에이전트 집합의 미래 궤적의 공동 분포를 위한 잡음 제거 확산 모델 기반 표현인 MotionDiffuser를 제시합니다(그림 2 참조). MotionDiffuser는 조건부 잡음 제거 확산 모델을 활용합니다. 잡음 제거 확산 모델[16, 23, 33, 43, 44](이하 확산 모델)은 잡음이 있는 데이터와 학습된 데이터 분포의 샘플을 기반으로 잡음 제거 함수를 학습하는 생성 모델 클래스로, 순수 가우시안 잡음에서 시작하여 잡음이 있는 샘플을 반복적으로 정제합니다(그림 1 참조). 확산 모델은 단순성, 복잡하고 고차원이며 다중 모드 분포를 표현하는 강력한 용량, 역문제를 해결하는 능력[4, 6, 24, 44], 이미지 생성[36, 37, 39], 비디오 생성[15, 18, 49], 3D 모양 생성[35]을 포함한 여러 문제 도메인에서의 효과성으로 인해 최근 엄청난 인기를 얻었습니다. 궤적 생성을 위한 기초로 조건부 확산 모델을 기반으로 다중 에이전트 동작 예측 문제에 대한 몇 가지 고유한 설계 개선 사항을 제안합니다. 첫째, 우리는 순서에 관계없이 에이전트 집합의 동작 분포를 학습하기 위한 교차 주의 기반 순열 불변 디노이저 아키텍처를 제안합니다. 둘째, 우리는 궤적의 임의의 미분 가능 비용 함수에 기반한 제어되고 안내되는 궤적 샘플링을 수행하기 위한 일반적이고 유연한 프레임워크를 제안합니다. 이를 통해 궤적에 대한 규칙 및 제어, 궤적 인페인팅 및 맞춤형 시뮬레이션 시나리오 생성과 같은 여러 가지 흥미로운 응용 프로그램을 사용할 수 있습니다. 마지막으로, 우리는 PCA 기반 잠재 궤적 확산 및 개선된 궤적 샘플 클러스터링을 포함하여 표현에 대한 여러 가지 개선 사항을 제안하여 모델의 성능을 더욱 높입니다. 요약하면, 이 작업의 주요 기여는 다음과 같습니다. • 조건부 확산 모델을 사용한 새로운 순열 불변, 다중 에이전트 조인트 동작 분포 표현. • 다양한 새로운 응용 프로그램을 갖춘 궤적의 임의의 미분 가능 비용 함수에 기반한 제어되고 안내되는 궤적 샘플링을 수행하기 위한 일반적이고 유연한 프레임워크. • PCA 기반 잠재 궤적 확산 공식화와 개선된 궤적 샘플 클러스터링 알고리즘을 포함하여 표현 방식에 여러 가지 중요한 개선 사항이 추가되어 모델 성능이 더욱 향상되었습니다. 2.
--- RELATED WORK ---
잡음 제거 확산 모델 잡음 제거 확산 모델 [16, 33]
--- METHOD ---
점수 기반 생성 모델 클래스와 논리적으로 높은 관련성이 있는 [23, 43, 44], 최근 이미지 생성 [36, 37, 39], 비디오 생성 [15, 18, 49] 및 3D 모양 생성 [35]을 포함한 광범위한 응용 분야에서 높은 샘플 품질을 입증하는 강력한 생성 모델 클래스로 등장했습니다. 우리는 에이전트의 조인트 동작을 예측하기 위해 확산 모델을 사용한 최초의 사람들 중 하나입니다. 제약 샘플링 확산 모델은 제어 가능한 샘플링 프로세스 [46, 22, 24, 43, 44]를 사용하여 이미지 인페인팅, 컬러화 및 희소 뷰 컴퓨터 단층 촬영과 같은 역문제를 해결하는 데 효과적인 것으로 나타났습니다. 동시 작업 [53]은 3.4절에서 비교하는 제어 가능한 교통 생성을 위한 확산 모델링을 탐구합니다. 확산 모델에서 생성 프로세스는 훈련 중에 사용할 수 없는 정보에 따라 조건을 지정할 수 있습니다. 역 문제는 학습된 무조건 분포 p(x)에 기반한 사후 p(x; y)에서 샘플링하는 것으로 제기될 수 있습니다. 여기서 y는 이벤트 x에 대한 관찰입니다. 추가적인 기술적 세부 사항은 Sec. 3.4로 미룹니다. apMotion 예측 동작 예측을 위한 접근 방식에는 지도 학습과 생성 학습의 두 가지 주요 범주가 있습니다. 지도 학습은 Lloss와 같은 지도 손실이 있는 기록된 궤적을 사용하여 모델을 학습합니다. 과제 중 하나는 에이전트의 고유한 다중 모드 동작을 모델링하는 것입니다. 이를 위해 MultiPath[40]는 정적 앵커를 사용하고 MultiPath++[48], Wayformer[31], Scene Transformer[32]는 학습된 앵커를 사용하고 DenseTNT[13]는 목표 기반 예측을 사용합니다. Home[9]과 GoHome[10]은 미래 점유 히트맵을 예측한 다음 샘플에서 궤적을 디코딩합니다. MP3[2]와 NMP[50]는 궤적의 비용 함수 평가자를 학습한 다음 출력 궤적을 휴리스틱하게 열거합니다. 이러한 접근 방식 중 다수는 더욱 다양한 예측을 위해 앙상블을 사용합니다. 다음 섹션에서는 생성적 접근 방식을 다룹니다. 동작 예측을 위한 생성 모델 최근 다양한 연구에서 동작 예측 작업을 생성 모델을 사용하여 p(s; c) 형태의 조건부 확률 추론 문제로 모델링했습니다. 여기서 s는 하나 이상의 에이전트의 미래 궤적을 나타내고 c는 맥락 또는 관찰을 나타냅니다. HP-GAN[1]은 개선된 Wasserstein 생성적 적대 네트워크(GAN)를 사용하여 이전 포즈에 따라 미래 인간 포즈의 확률 밀도 함수(PDF)를 학습합니다. 조건부 변분 자동 인코더(C-VAES)[11, 20, 34], 정규화 흐름[8, 28, 29, 41]도 동작 예측을 위한 미래 궤적의 이 조건부 PDF를 학습하는 데 효과적인 것으로 나타났습니다. 아주 최근의 연구에서는 인간 동작 포즈 시퀀스[38, 52] 및 계획[21]과 같은 미래 시퀀스의 조건부 분포를 모델링하는 대안으로 확산 모델을 조사하기 시작했습니다. 더 관련성 있는 작업[14]에서 저자는 보행자 동작의 불확실성을 모델링하기 위해 확산 모델을 활용합니다. 우리가 아는 한, 다중 에이전트 조인트 동작 분포를 모델링하기 위해 확산 모델을 활용한 것은 우리가 처음입니다. 다중 에이전트 동작 예측 동작 예측에 대한 많은 문헌이 개별 에이전트의 동작을 독립적으로 예측하는 데 주력했지만, 여러 에이전트의 동작을 공동으로 모델링하는 작업도 있었습니다. SceneTransformer[32]는 장면의 모든 에이전트에 대한 고정된 조인트 동작 예측 세트를 출력합니다. M2I[45], WIMP[25], PIP[42] 및 CBP[47]는 제어되는 에이전트의 주어진 동작에 의해 다른 에이전트의 동작이 예측되는 조건부 모델을 제안합니다. 확률적 그래픽 모델을 사용하는 문헌 세트가 있습니다. DSDNet[51] 및 MFP[46]는 완전 연결 그래프를 사용합니다. JFP[27]는 완전 연결 그래프 및 자율 주행차 중심 그래프와 같은 정적 그래프와 상호 작용하는 에이전트 간에 에지가 구성된 동적 그래프를 지원합니다. RAIN[26]은 별도의 RL 학습을 통해 상호 작용의 동적 그래프를 학습합니다. 3. 방법 3.1. 확산 모델 예비 지식 예비 지식 확산 모델[23]은 학습 가능한 매개변수 0을 통해 확률 분포 po(x)의 학습된 매개변수화를 제공합니다. 이 확률 밀도 함수를 표준 편차 σ의 가우시안 커널과 합성하여 po(x, σ)로 표시합니다. 정규화 상수가 일반적으로 다루기 힘든 [19] 정규화된 확률 밀도 함수 po(x)를 직접 학습하는 대신, 확산 모델은 노이즈 레벨 σ 범위에서 분포의 점수 함수 Vx log po(x; σ)를 학습합니다. 점수 함수 Vx log po (x; σ)가 주어지면 노이즈 샘플의 노이즈를 제거하여 분포에서 샘플링할 수 있습니다. 샘플은 다음 역학을 통해 기본 분포 x ~ pe(x)에서 추출할 수 있습니다. x₁ = x (T) + [°³ − ō (t)σ (t) ▼ x log pa (x(t); σ (t))dt 여기서 x(T) ~N(0,0 max) (1) 여기서 분산 σ(t)는 시간 t의 보조 매개변수의 단조롭고 결정적인 함수입니다. [23]에 따라 선형 노이즈 일정 σ(t) =t를 사용합니다. 초기 노이즈 샘플은 가장 높은 표준 편차 σ(T) = σmax로 스케일된 단위 가우시안에서 iid 샘플링됩니다. 확산 모델은 데이터 분포 px(x)를 근사하도록 학습할 수 있으며, 여기서 x = {x1, x2,, xNd}는 학습 데이터 세트를 나타냅니다. 데이터의 경험적 분포는 각 Nd 데이터 포인트 주변의 델타 함수의 합으로 볼 수 있습니다: px(x) (xx). 노이즈 제거기를 D(x; σ)로 표시하는데, 이는 노이즈가 있는 샘플 x에 해당하는 노이즈가 없는 샘플을 복구하는 함수입니다. 노이즈 제거기는 다음을 통해 점수 함수와 관련됩니다. =n (2) ▼x log p(x; σ) = (D(x; 0) — x)/o² 노이즈 제거기는 노이즈 분포 q(σ)에서 샘플링된 모든 노이즈 레벨 ☛에서 교란된 샘플 x에 대한 예상 L노이즈 제거 오류를 최소화하여 학습할 수 있습니다. arg min Ex~px Eoq(0) E~N(0,021)||D0(x + €; σ) − x|| Ꮎ (3) 노이즈 레벨 푸리에 임베딩 연결 조건 토큰 AgentC¹. Agent N CN Na Ne S1 σ SSS[투영] SNa O SNa SNa SNa [자체 어택] [X-어택] 노이즈가 있는 궤적 반복 2 x S[투영] SNa 노이즈가 제거된 궤적 Do (S; C, σ). SN₁은 먼저 conFigure 3. 에이전트에 해당하는 세트 디노이저 노이즈 궤적에 대한 네트워크 아키텍처 랜덤 푸리에 인코딩된 노이즈 레벨 σ로 스캐테이닝된 후, 궤적 세트 간의 자기 주의와 조건 토큰 C1 CNC에 대한 교차 주의의 반복적인 블록을 거칩니다. 자기 주의는 확산 모델이 에이전트 전체에 걸친 공동 분포를 학습할 수 있게 하고, 교차 주의는 모델이 더 정확한 장면 조건 분포를 학습할 수 있게 합니다. 각 에이전트는 에이전트 중심 장면 인코딩에서 자체 조건 토큰에 교차 주의를 기울인다는 점에 유의하세요(단순화를 위해 표시하지 않음). [학습 가능한 구성 요소]는 괄호로 표시했습니다. 조건부 확산 모델 이 작업에서 우리는 po(x; c)를 학습하는 조건부 설정에 관심이 있습니다. 여기서 x는 에이전트 세트의 미래 궤적을 나타내고 c는 장면 컨텍스트입니다. 간단한 수정은 노이즈 제거기 D(x; c, σ)와 점수 함수 Vx log p(x; c, σ)를 조건 c로 증가시키는 것입니다. 다음 조건으로 증가된 데이터 집합 Xc가 주어지면: Xc {(x1, C₁),, (x N₁, CN)}, 조건부 노이즈 제거기는 다음을 최소화하는 조건부 노이즈 제거 점수 매칭 목적으로 학습할 수 있습니다. Ex,cx Eong(o)E~N(0,021)||D0(x + €; c, σ) − x | | 1/ 이는 학습된 조건부 점수 함수로 이어집니다. Vx log po (x; c, σ) = (D0(x; c, σ) − x)/o² (4) (5) 사전 조건화 및 학습 노이즈 제거 점수 매칭 목적(식 4)으로 모델을 직접 학습하는 데는 여러 가지 단점이 있습니다. 첫째, 노이즈 제거기의 입력은 단위가 아닌 분산을 갖습니다.Var(x + €) = Var(x) + Var(e) = σata+σ², σ € [0, σmax].둘째, 노이즈 레벨 σ가 작을 때 모델이 깨끗한 신호를 예측하는 것보다 잔여 노이즈를 예측하는 것이 훨씬 쉽습니다.[23]에 따라 노이즈 제거기의 사전 조건화된 형태를 채택합니다.De(x; c, σ) = Cskip (σ) x + Cout (σ) Fe (Cin (0) x; C, Cnoise (σ)) (6) Fo는 학습할 신경망이고, Cskip, Cin, Cout, Cnoise는 각각 건너뛰기 연결을 노이즈가 있는 x, 네트워크에 대한 입력, 네트워크의 출력, 노이즈 입력 σ로 스케일합니다. 인코더 네트워크의 출력이므로 변조된 스케일을 갖는다고 가정하므로 추가로 c를 스케일하지 않습니다.샘플링 예측을 샘플링할 때 Eqn. 1의 ODE 동역학을 따릅니다. 우리는 기본 매개변수와 32 샘플링 단계를 사용하여 해당 ODE를 풀기 위해 Huen의 2차 방법을 활용합니다.3.2. 다중 에이전트 궤적에 대한 확산 모델 이 작업의 주요 기여 중 하나는 확산 모델을 사용하여 다중 에이전트 궤적의 공동 분포를 모델링하기 위한 프레임워크를 제안하는 것입니다.에이전트 i의 미래 궤적을 s;ER NtNf로 표시합니다.여기서 Nt는 미래 시간 단계 수이고 Nƒ는 종방향 및 횡방향 위치, 진행 방향 등과 같은 시간 단계당 특징 수입니다.ci ER을 도로 그래프, 신호등, 모델링된 에이전트와 컨텍스트 에이전트의 기록, 그리고 에이전트 i를 중심으로 한 이러한 장면 요소 내의 상호 작용을 포함하여 장면의 학습된 자기 중심적 컨텍스트 인코딩으로 표시합니다.일반적으로 c는 단일 조건 벡터 또는 컨텍스트 토큰 세트로 임의의 차원이 될 수 있습니다. 에이전트 미래 궤적의 집합을 SERNaNtNƒ로, 자아 중심적 맥락 인코딩의 집합을 CE R³×***로 표시하고, 여기서 |S| = |C| = Na는 모델링된 에이전트의 수입니다. 각 에이전트의 위치와 방향(자아 차량에 대한)을 해당 맥락 벡터에 추가합니다. 두 집합의 에이전트의 j번째 순열을 S³, C³로 표시하고, 에이전트의 일관된 순서를 공유합니다. 확산 모델을 사용하여 에이전트 궤적의 집합 확률 분포를 모델링하려고 합니다: p(S³; C³). 장면에서 에이전트 순서가 임의적이므로 순열 불변 집합 확률 분포를 학습하는 것이 필수적입니다.즉, p(S; C) = p(S³ ; C³), Vj € [1, Na!] (7) 순열 불변 집합 확률 분포를 학습하려면 순열 등가 노이즈 제거기를 학습해야 합니다.즉, 노이즈 제거기의 에이전트 순서가 순열일 때 노이즈 제거기 출력은 동일한 순열을 따릅니다.D(S³ ; C³, 0) = D³ (S; C, 0), Vj € [1, Na!] (8) 노이즈 제거기 아키텍처에 대한 또 다른 주요 고려 사항은 조건 텐서 c와 노이즈 레벨 σ를 효과적으로 처리할 수 있는 능력입니다.이 두 가지 동기 모두 우리가 주 노이즈 제거기 아키텍처로 변환기를 활용하도록 촉구합니다. 우리는 최신 Wayformer [31] 모델의 장면 인코더 아키텍처를 활용하여 도로 그래프, 에이전트 기록 및 신호등 상태와 같은 장면 요소를 잠재적 임베딩 세트로 인코딩합니다. 노이즈 제거기는 각 에이전트에 해당하는 GT 궤적을 입력으로 받고, 랜덤 노이즈 레벨 σ ~ q(σ)로 교란하고 노이즈 레벨 σ를 받습니다. 노이즈 제거 프로세스 동안 노이즈가 있는 입력은 에이전트 간의 자기 주의와 에이전트당 컨텍스트 토큰 세트에 대한 교차 주의의 반복적인 블록을 거치고, 마지막으로 결과는 입력과 동일한 피처 차원으로 투영됩니다. 에이전트 차원을 따라 위치 인코딩을 적용하지 않으므로 변환기는 자연스럽게 ←← THE K를 보존합니다. 그림 4. 에이전트당 64개 샘플링된 궤적의 추론된 정확한 로그 확률. 확률이 높은 샘플은 밝은 색상으로 표시됩니다. 주황색 에이전트는 AV(자율 주행차)를 나타냅니다. 토큰(에이전트) 간의 동치성으로, 노이즈 제거기 모델의 순열 동치성이 발생합니다. 그림 3은 변압기 기반 잡음 제거기 구조의 더 자세한 설계를 보여줍니다.3.3. 정확한 로그 확률 추론 이 모델을 사용하면 다음 방법을 통해 생성된 샘플의 정확한 로그 확률을 추론할 수 있습니다.먼저 시간에 따른 로그 밀도의 변화는 순간 변수 변화 공식 [3]이라고 하는 두 번째 미분 방정식을 따릅니다.log p(x(t)) Ət = −Tr af dx(t) 여기서 f = x/ǝt 확산 모델에서 흐름 함수 ƒ는 다음과 같습니다.f(x(t),t) = dx(t) Ət (9) = −σ(t)σ(t)▼× log p(x(t); σ(t)) (10) 샘플의 로그 확률은 아래와 같이 시간에 따른 적분을 통해 계산할 수 있습니다. logp(x(0)) = log p(x(T)) – Sp -Lo Tr (20ft) d Τ (į af dt (11) 야코비안의 트레이스 계산은 x의 차원인 n을 갖는 O(n²)가 걸립니다. 3.5절에서처럼 PCA를 사용하는 경우 n은 원래 데이터의 차원보다 훨씬 작을 것입니다. FFJORD [12]에서처럼 O(n)을 갖는 Hutchinson의 트레이스 추정기를 사용할 수도 있습니다. 로그 확률은 더 높은 확률 예측을 필터링하는 데 사용할 수 있습니다. 예를 들어, 그림 4에서 더 밝은 색상으로 표시된 더 높은 확률 샘플이 더 가능성이 높습니다. 3.4. 궤적 샘플 제한 제한된 궤적 샘플링에는 다양한 응용 프로그램이 있습니다. 샘플링된 궤적의 제어 가능성이 필요한 한 가지 상황은 물리적 규칙과 제약 조건을 주입하는 것입니다. 예를 들어, 에이전트 궤적은 정적 개체 및 다른 도로 사용자와의 충돌을 피해야 합니다. 또 다른 응용 프로그램은 다음을 수행하는 것입니다. 궤적 인페인팅: 하나 이상의 제어점이 주어진 궤적 예측을 완료하는 역문제를 해결하는 것입니다. 이는 자율 주행차 개발 및 시뮬레이션을 위한 맞춤형 교통 시나리오를 만드는 데 유용한 도구입니다. 더 공식적으로, 우리는 궤적에 대한 학습된 미래 분포인 p(S; C) · q(S; C)에서 샘플링하는 솔루션을 찾습니다. q(S; C)는 S에 대한 제약 매니폴드를 나타내는 2차 분포입니다. 이 공동 분포의 점수는 Vs log (p(S; C) · q(S; C) Vs log p(S; C) + Vs log q(S; C)입니다. 이 공동 분포를 샘플링하려면 모든 노이즈 레벨 σ에서 공동 점수 함수가 필요합니다. = Vs log p(S; C, σ) + Vs log q(S; C, σ) (12) 첫 번째 항은 Eqn. 5의 조건부 점수 함수에 직접 해당합니다. 두 번째 항은 제약 조건에 따른 그래디언트 안내를 설명하는데, 이는 특수 신경망이 다양한 노이즈 레벨에서 이 안내 항을 추정하도록 훈련되는 클래스 조건부 이미지 생성 작업에서 분류기 기반 안내[17]와 유사합니다. 이를 제약 그래디언트 점수라고 합니다. 그러나 우리의 목표는 궤적의 임의의 미분 가능 비용 함수로 제약 조건 기울기 점수를 근사하는 것이므로, 이것이 어떻게 노이즈 매개변수 σ의 함수가 될 수 있을까요? 핵심적인 통찰력은 모든 중간 노이즈 궤적 S와 해당 노이즈 레벨 D(S; C, σ)에서 노이즈가 제거된 궤적 간의 이중성을 활용하는 것입니다. S는 물리적 궤적이 아니라 데이터 매니폴드에서 분명히 벗어났지만, D(S; C, σ)는 일반적으로 높은 σ 값에서도 기준 진실(Eqn. 4)에 대해 회귀하도록 훈련되었기 때문에 데이터 매니폴드에 있는 물리적 궤적과 매우 유사합니다. 잡음이 제거된 이벤트와 잡음이 있는 이벤트는 σ → 0의 한계에서 수렴합니다.이에 따라 제약 조건 그래디언트 점수를 다음과 같이 근사합니다.მ (13) Vs log q(S; C, 0) ≈ 5 (D(S; C, 0)) 여기서 L RaxNt×Nƒ → R은 샘플링된 궤적 집합에 대한 임의의 비용 함수이고, \는 이 제약 조건의 가중치를 제어하는 하이퍼파라미터입니다.이 연구에서는 궤적 제어를 위한 두 가지 간단한 비용 함수, 즉 어트랙터와 리펠러를 도입합니다.어트랙터는 특정 시간 단계에서 예측된 궤적이 특정 위치에 도착하도록 합니다.리펠러는 상호 작용하는 에이전트가 서로 너무 가까이 다가가는 것을 방지하고 충돌을 완화합니다.비용은 다음과 같이 정의합니다.어트랙터 비용 Lattract (D(S; C, 0)) Σ(D(S; C, 0) — Starget) Mtarget | Σ|Mtarget + eps (14) 여기서 Starget RNa×NtNƒ는 대상 위치 텐서이고, Mtarget은 Starget에서 적용할 위치를 나타내는 이진 마스크 텐서입니다. ●는 요소별 곱을 나타내고 eps는 언더플로를 방지하기 위한 무한소 값을 나타냅니다. 반발기 비용 A = max ((1-A(D(S; C, 0))) (1-1),0) (15) = r ΣΑ Σ(A &gt; 0) + eps (16) Crepell (D(S)) = 여기서 A는 시간 단계당 반발기 비용입니다. 모든 시간 단계에서 모든 잡음 제거 에이전트 쌍 간의 쌍별 L2 거리 함수를 A(D(S; C, 0)) E RNa Na Nt, 모든 Nt 시간 단계에 브로드캐스트되는 동일성 텐서 IЄRNax NaXNt, 반발기 반경을 r로 표시합니다. 제약 점수 임계값 제약 샘플링 프로세스의 안정성을 더욱 높이기 위해 간단하고 효과적인 전략인 제약 점수 임계값(ST)을 제안합니다.식 2에서 다음이 관찰됩니다.σ√x log p(x; σ) = (D(x, σ) - x)/σ = €, e ~ N(0, 1) (17) 따라서 요소별 클리핑 함수를 통해 식 13의 제약 점수를 조정합니다.Vs log q(S; C, σ) := clip(o Vs log q(S; C, σ), ±1)/(18) 표 2에서 이 설계 선택을 제거합니다.3.5. 궤적 표현 향상 샘플 클러스터링 MotionDiffuser는 임의의 수의 샘플을 추출할 수 있는 가능한 공동 미래 궤적의 전체 분포를 학습하지만, 종종 출력 분포에서 더 제한된 수의 대표 모드를 추출해야 합니다. 예를 들어 Waymo Open Motion Dataset의 Interaction Prediction 챌린지는 모델링된 에이전트에서 예측된 6개의 조인트 퓨처 집합을 기반으로 메트릭을 계산합니다.따라서 더 큰 샘플링된 궤적 집합에서 대표적인 집합을 생성해야 합니다.이를 위해 [48]에 정의된 궤적 집계 방법을 따릅니다.이 방법은 반복적 탐욕적 클러스터링을 수행하여 궤적 샘플이 출력 클러스터까지의 고정 거리 임계값 내에 들어갈 확률을 최대화합니다.클러스터링 알고리즘에 대한 자세한 내용은 [48]을 참조하세요.조인트 에이전트 예측 설정에서 클러스터링 알고리즘을 수정하여 각 조인트 예측 샘플에 대해 모든 에이전트 예측이 출력 클러스터까지의 거리 임계값 내에 들어갈 확률을 최대화합니다.PCA 잠복 확산 이미지 생성을 위한 잠복 확산 모델[37]의 최근 성공에서 영감을 받아 주성분 분석(PCA)을 사용하여 궤적에 대한 압축 표현을 활용합니다. PCA는 궤적을 표현하는 데 특히 적합합니다. 궤적은 시간적, 기하학적으로 본질적으로 매끄럽고 궤적은 매우 작은 구성 요소 집합으로 표현할 수 있기 때문입니다. 저희 분석에 따르면 80×2 자유도의 궤적에 대한 3개의 구성 요소만으로 설명된 모든 분산의 99.7%를 설명할 수 있지만, 저희는 더 정확한 재구성을 위해 10개의 구성 요소를 사용합니다. PCA 표현에는 더 빠른 추론, 제어된 궤적에 대한 더 나은 성공, 그리고 아마도 가장 중요한 것은 더 나은 정확도와 성능을 포함하여 여러 가지 이점이 있습니다(5절의 절제 연구 참조). 첫째, 많은 기준 진실 궤적에 시간 단계가 누락되어 있기 때문에(폐쇄/에이전트가 장면을 떠나기 때문) 선형 보간/외삽법을 사용하여 각 궤적에서 누락된 단계를 채웁니다. 영어: 우리는 Ns = 105개의 에이전트 궤적의 대규모 모집단을 균일하게 샘플링합니다.여기서 각 궤적 Si Є R³±Ñƒ‚ i Є [1, N]은 먼저 에이전트의 현재 위치를 중심으로 하고, 에이전트의 방향이 +y 방향이 되도록 회전한 다음, 단일 벡터로 평평하게 만듭니다.이 에이전트 궤적의 무작위 하위 집합을 S&#39;E RN,XN₁Nƒ로 표시합니다.우리는 이에 해당하는 주성분 행렬(백색화 포함)을 Wpca Є RNp×(NtNf)로 계산합니다.여기서 Np는 사용할 주성분의 수이고, 평균은 s&#39; ЄRNtNf입니다.우리는 각 궤적 Si에 대한 PCA 및 역 PCA 변환을 다음과 같이 구합니다.pca ŝi = (Si — §)Wa ⇒ Si = ŝi(Wa)¯¹ + 5 (19) 새로운 표현을 사용하면 Eqn에서 에이전트 궤적이 있습니다. 7은 PCA 공간에서 SERNaXNp. 4로 표시됩니다.
--- EXPERIMENT ---
및 결과 4.1. PCA 모드 분석 = 간단하고 정확한 압축 궤적 표현으로 PCA를 사용하는 데 대한 동기를 부여하기 위해 Waymo Open Dataset 훈련 분할에서 무작위로 선택한 Ns 105 궤적에서 계산된 주성분을 분석합니다.그림 5a는 증가하는 수의 주성분을 사용하여 웨이포인트당 평균 재구성 오류를 보여줍니다.처음 10개의 주성분만 유지할 때 평균 재구성 오류는 0.06미터로 최첨단 방법으로 달성한 평균 예측 오류보다 상당히 낮습니다.이는 [37]의 자동 인코더와 같은 보다 복잡한 전략이 필요하지 않은 효과적인 압축 전략으로 PCA를 동기를 부여합니다.그림 5b에서 상위 10개 주성분을 시각화합니다.더 높은 차수의 주성분은 점점 더 유사해지고 데이터 세트 평균에서 약간만 벗어납니다.이러한 성분은 모델링과 관련이 없는 고주파 궤적 정보를 나타내며 지각 노이즈의 결과일 수도 있습니다. PCA 재구성 오류(m) 0.0.0.0.0.0.0.####5,7,##방법 중복 minSADE minSFDE sMissRate MAP (↓) (↓) (↓) (↓) (↑) LSTM 기준선 [7] 1.5.0.0.HeatIRm4 [30] 1.3.0.72 0.Scene Transformer(J) [32] 0.2.0.0.M2I [45] 1.2.0.55 0.Test Dense TNT [13] 1.2.0.54 0.MultiPath++[48] 1.2.0.54 0.JFP [27] 0.1.0.0.MotionDiffuser(우리의 것) 0.1.0.0.Scene Transformer(M) [32] 0.1.2.0.0.Scene Transformer(J) [32] 0.0.2.0.0.Val MultiPath++ [48] 0.1.2.0.0.JFP [27] 0.0.1.0.0.Wayformer [31] 0.0.2.0.0.MotionDiffuser(저희의 것) 0.0.1.0.42 0. PCA 구성 요소 수 (a) PCA 궤적 재구성 오류 대 PCA 구성 요소 수. (b) 궤적에 대한 상위 10개 PCA 구성 요소의 시각화. 그림 5. 에이전트 궤적에 대한 PCA 표현 분석. (a)는 다양한 수의 주성분에 대한 평균 재구성 오류를 보여줍니다. (b)는 최상위 주성분의 시각화를 보여줍니다. 더 높은 주파수를 나타내는 더 높은 모드는 점점 더 유사하며 최종 궤적에 미치는 영향이 작습니다. 표 1. WOMD 상호 작용 분할: t = 3, 5, 8초 동안 모든 객체 유형에 대해 평균화된 장면 수준 조인트 메트릭 수를 보고합니다. 메트릭 minSADE, minSFDE, SMissRate 및 mAP는 벤치마크 [7]에서 가져온 것입니다. 오버랩은 [27]에 정의되어 있습니다. 방법 4.2. 다중 에이전트 동작 예측 다중 에이전트 예측 설정에서 MotionDiffuser의 성능을 평가하기 위해, 매우 상호 작용적이고 다양한 시나리오에서 에이전트 쌍이 포함된 Waymo Open Dataset 상호 작용 분할에서 방법을 평가합니다 [7]. 표 1에서는 [7]에 정의된 대로 상호 작용 분할에 대한 주요 메트릭을 보고합니다. minSADE는 기준 진실 미래 에이전트 궤적과 가장 가까운 조인트 예측(6개의 조인트 예측 중) 간의 변위를 측정하며, 미래 시간적 범위와 상호 작용하는 에이전트 쌍에 걸쳐 평균화됩니다. minSFDE는 시간적 범위 끝점에서 최소 조인트 변위 오류를 측정합니다. SMissRate는 에이전트 속도와 미래 시간 단계의 함수로 정의된 거리 임계값을 사용하여 조인트 예측의 재현율을 측정합니다.마지막으로 mAP는 좌회전 및 유턴과 같은 에이전트 동작 유형을 기반으로 조인트 평균 평균 정밀도를 측정합니다.보고된 메트릭은 미래 시간 범위(3초, 5초 및 8초)와 에이전트 유형(차량, 보행자 및 자전거 타는 사람)에 따라 평균화됩니다.또한 일관된 조인트 예측은 충돌해서는 안 되므로 모델 예측의 일관성을 포착하는 가장 가능성 있는 조인트 예측에 대한 오버랩 비율을 측정하여 오버랩 메트릭[27]에 대한 결과를 보고합니다.우리의 모델은 표 1에 표시된 것처럼 최첨단 결과를 달성합니다.MotionDiffuser와 Wayformer[31]는 동일한 백본을 사용하지만 확산 헤드의 강도로 인해 모든 메트릭에서 우리의 방법이 상당히 더 나은 성능을 보입니다.테스트 분할에서 JFP[27]와 비교할 때 minSADE 및 minSFDE 메트릭과 관련하여 개선되었음을 보여줍니다. mAP와 Overlap의 경우, 우리 방법은 JFP보다 성능이 약간 떨어지지만 다른 모든 방법보다 우수한 것으로 나타났습니다. 현실성(↓) 제약 효과성 5.385 0.1.947 0.2.083 0.2.194 0.minSADE meanSADE Overlap minSFDE(↓) meanSFDE(↓) SR2m(†) SR5m(↑) 제약 없음 1.261 3.239 0.Attractor(GT 최종 지점으로) 최적화 4.GTC[53] 1.Ours(-ST) 1.Ours 0.2.8.0.0.0.0.074 1.1.0.0.838 0.0.0.1.078 0.0.0.0.747 0.0.1.359 3.229 0.2.8.888 0.0.Repeller(에이전트 쌍 사이) Ours 표 2. 다음에 대한 양적 검증 제어 가능한 궤적 합성. 3.4절에서 어트랙터 또는 리펠러 제약 조건을 적용합니다. 4.3. 제어 가능한 궤적 합성 제어 가능한 궤적 합성 접근 방식의 효과를 실험적으로 검증합니다. 특히 3.4절에서 제안한 어트랙터 및 리펠러 설계를 검증합니다. Waymo Open Motion Dataset의 Interactive Split을 사용하여 이러한 실험을 계속합니다. 어트랙터와 리펠러 모두에 대한 실험에서 4.2절에서 학습한 동일한 기준 확산 모델을 사용합니다. 예측 분포에서 64개 궤적을 무작위로 샘플링합니다. 표 2에 결과를 보고합니다. 4.2절에 따라 최소/평균 ADE/FDE 및 중복 메트릭을 측정합니다. 평균 메트릭은 64개 예측에 대한 평균 수량을 계산합니다. 어트랙터 실험의 경우 모든 예측 궤적의 마지막 지점이 기준 진실 데이터의 마지막 지점에 가깝도록 제한합니다. 따라서 min/meanSADE는 예측의 현실성과 데이터 매니폴드에 얼마나 가깝게 유지되는지에 대한 프록시 역할을 합니다. 기준선의 경우 두 가지 접근 방식과 비교합니다. &quot;최적화&quot;는 확산 모델에서 궤적을 직접 샘플링한 다음 Adam 최적화를 통한 후처리 단계를 거쳐 제약 조건을 적용합니다. &quot;CTG&quot;는 확산 프로세스의 모든 단계에서 노이즈가 제거된 샘플에 제약 조건을 적용하기 위해 내부 최적화 루프를 수행하는 동시 작업[53]에서 샘플링 방법을 다시 구현한 것입니다. 자세한 결과는 표 2를 참조하십시오. 샘플링 후 궤적 최적화 단일 에이전트 제약 다중 에이전트 제약 B BA 제약 조건 없음 A A 최적화 日 K 제약 조건 없음 최적화 CTG CTG 日 Ours Ours 그림 6. 제어 가능한 궤적 합성에 대한 정성적 결과. 궤적의 마지막 지점에 어트랙터 기반 제약 조건(X로 표시)을 적용합니다. 추론 시점에 제약 조건이 없으면 MotionDiffuser(&quot;제약 조건 없음&quot;)의 초기 예측 분포는 그럴듯하지만 분산됩니다. 예측된 궤적의 테스트 시간 최적화는 모델 출력에 대한 제약 조건을 적용하는 데 효과적이지만 데이터 매니폴드와 크게 벗어나 비현실적인 출력을 생성합니다. 저희 방법은 현실적이고 잘 제약된 결과. 방법 minSADE(↓) minSFDE(↓) SMissRate(↓) Ours (-PCA) 1.2.0.Ours (-Transformer) 0.2.0.Ours (-SelfAttention) 0.2.0.MotionDiffuser (Ours) 0.1.0.표 3. WOMD 상호 작용 검증 분할에 대한 제거. 우리는 노이즈 제거기 아키텍처의 구성 요소와 PCA 압축 궤적 표현을 제거합니다. 프로세스는 제약 조건을 적용하는 데 가장 강력한 효과가 있지만 비현실적인 궤적을 생성합니다. 우리의 방법을 사용하면 최적화 방법에 이어 궤적을 적용하는 데 높은 수준의 효과성을 얻는 동시에 높은 수준의 사실성을 유지합니다. 또한 그림 6에서 최적화된 궤적에 대한 정성적 비교를 보여줍니다. 반발 실험의 경우 모델링된 모든 에이전트 쌍 사이에 반발 제약 조건(반경 5m)을 추가합니다. 우리는 모델링된 에이전트 사이에서 반발하는 데 효과적인 조인트 예측 간의 중복을 10배나 크게 줄일 수 있었습니다.5. 절제 연구 우리는 표 2에서 제안한 점수 임계값(ST) 접근 방식의 효과를 검증합니다.Ours(-ST)는 이 기술을 제거했음을 나타내며, 제약 조건 만족도가 상당히 저하되었습니다.또한 표 3에서 MotionDiffuser 아키텍처의 중요한 구성 요소를 절제합니다.압축되지 않은 궤적 표현 Ours(-PCA)를 사용하면 성능이 상당히 저하됩니다.또한 Transformer 아키텍처를 간단한 MLP Ours(Transformer)로 바꾸면 성능이 저하됩니다.또한 노이즈 제거 아키텍처 Ours(SelfAttention)에서 자체 주의 레이어를 절제하는 반면 교차 주의 레이어는 유지합니다(장면 컨텍스트 및 노이즈 수준에 대한 조건을 허용하기 위해).이 결과는 모델링된 에이전트의 노이즈가 있는 미래 궤적 간의 주의가 일관된 조인트 예측을 생성하는 데 중요하다는 것을 보여줍니다. 표 3에서 MotionDiffuser의 성능은 Wayformer 인코더 백본 크기가 줄어들었기 때문에 표 1보다 약간 떨어집니다.
--- CONCLUSION ---
및 토론 이 작업에서 우리는 다양한 다중 에이전트에 대한 다중 모드 조인트 미래 분포를 학습할 수 있는 새로운 확산 모델 기반 다중 에이전트 동작 예측 프레임워크인 MotionDiffuser를 소개했습니다. 우리는 에이전트 간에 순열 불변인 새로운 변환기 기반 세트 디노이저 아키텍처를 제안합니다. 나아가 우리는 일반적이고 유연한 제약 샘플링 프레임워크를 제안하고 두 가지 간단하고 유용한 제약 조건인 어트랙터와 레펠러의 효과를 보여줍니다. 우리는 최첨단 다중 에이전트 동작 예측 결과와 Waymo Open Motion Dataset에서 우리 접근 방식의 효과를 보여줍니다. 향후 작업에는 자율 주행차의 계획 및 장면 생성과 같은 다른 관심 주제에 확산 기반 생성 모델링 기술을 적용하는 것이 포함됩니다. 감사의 말 오버랩 메트릭 코드에 도움을 준 Wenjie Luo, 다중 에이전트 NMS에 도움을 준 Ari Seff, 도움이 되는 토론을 해준 Rami Al-RFou, Charles Qi 및 Carlton Downey, 원고를 검토해 준 Joao Messias, 익명의 검토자에게 감사드립니다. 참고문헌 [1] Emad Barsoum, John Kender, Zicheng Liu. Hp-gan: gan을 통한 확률적 3차원 인간 동작 예측. IEEE 컴퓨터 비전 및 패턴 인식 워크숍 회의록, 1418-1427쪽, 2018년.[2] Sergio Casas, Abbas Sadat, Raquel Urtasun. Mp3: 매핑, 인식, 예측 및 계획을 위한 통합 모델. IEEE/CVF 컴퓨터 비전 및 패턴 인식 회의록, 14403-14412쪽, 2021년.[3] Ricky TQ Chen, Yulia Rubanova, Jesse Bettencourt, David K Duvenaud. 신경 상미분 방정식. 신경 정보 처리 시스템의 발전, 31, 2018년.[4] Jooyoung Choi, Sungwon Kim, Yonghyun Jeong, Youngjune Gwon, Sungroh Yoon. Ilvr: 확산 확률적 모델의 노이즈 제거를 위한 조건화 방법. arXiv 사전 인쇄본 arXiv:2108.02938, 2021. 2,[5] Hyungjin Chung, Byeongsu Sim, Dohoon Ryu, and Jong Chul Ye. 매니폴드 제약 조건을 사용하여 역문제에 대한 확산 모델 개선. arXiv 사전 인쇄본 arXiv:2206.00941, 2022. [6] Hyungjin Chung, Byeongsu Sim, and Jong Chul Ye. Come-closer-diffuse-faster: 확률적 수축을 통해 역문제에 대한 조건부 확산 모델 가속화. IEEE/CVF 컴퓨터 비전 및 패턴 인식 컨퍼런스 회의록, 12413-12422페이지, 2022. 2,[7] Scott Ettinger, Shuyang Cheng, Benjamin Caine, Chenxi Liu, Hang Zhao, Sabeek Pradhan, Yuning Chai, Ben Sapp, Charles Qi, Yin Zhou, Zoey Yang, Aurelien Chouard, Pei Sun, Jiquan Ngiam, Vijay Vasudevan, Alexander McCauley, Jonathon Shlens, Dragomir Anguelov. 자율 주행을 위한 대규모 대화형 동작 예측: Waymo 오픈 모션 데이터 세트. arXiv 사전 인쇄본 arXiv:2104.10133, 2021.[8] Samuel G Fadel, Sebastian Mair, Ricardo da Silva Torres, Ulf Brefeld. 흐름 정규화를 기반으로 하는 상황적 동작 모델. AStA Advances in Statistical Analysis, 1-22페이지, 2021.[9] Thomas Gilles, Stefano Sabatini, Dzmitry Tsishkou, Bogdan Stanciulescu, Fabien Moutarde. 홈: 향후 동작 추정을 위한 히트맵 출력. 2021년 IEEE 국제 지능형 교통 시스템 컨퍼런스(ITSC), 500-507페이지. IEEE, 2021.[10] Thomas Gilles, Stefano Sabatini, Dzmitry Tsishkou, Bogdan Stanciulescu, Fabien Moutarde. Gohome: 향후 동작 추정을 위한 그래프 지향 히트맵 출력. 2022년 국제 로봇 및 자동화 컨퍼런스(ICRA), 9107-9114페이지. IEEE, 2022.[11] Sebastian Gomez-Gonzalez, Sergey Prokudin, Bernhard Schölkopf, Jan Peters. 심층 조건 생성 모델을 사용한 실시간 궤적 예측.IEEE Robotics and Automation Letters, 5(2):970–976, 2020.[12] Will Grathwohl, Ricky TQ Chen, Jesse Bettencourt, Ilya Sutskever, David Duvenaud.Ffjord: 확장 가능한 가역 생성 모델을 위한 자유형 연속 동역학.arXiv 사전 인쇄본 arXiv:1810.01367, 2018.[13] Junru Gu, Qiao Sun, Hang Zhao.Densetnt: Waymo 오픈 데이터 세트 동작 예측 챌린지 1위 솔루션.CORR, abs/2106.14160, 2021.3,[14] Tianpei Gu, Guangyi Chen, Junlong Li, Chunze Lin, Yongming Rao, Jie Zhou, Jiwen Lu. 동작 불확정성 확산을 통한 확률적 궤적 예측. IEEE/CVF 컴퓨터 비전 및 패턴 인식 컨퍼런스 회의록, 17113-17122페이지, 2022.[15] Jonathan Ho, William Chan, Chitwan Saharia, Jay Whang, Ruiqi Gao, Alexey Gritsenko, Diederik P Kingma, Ben Poole, Mohammad Norouzi, David J Fleet, et al. Imagen video: 확산 모델을 사용한 고화질 비디오 생성. arXiv 사전 인쇄본 arXiv:2210.02303, 2022.[16] Jonathan Ho, Ajay Jain, Pieter Abbeel. 확산 확률적 모델의 잡음 제거. 신경 정보 처리 시스템의 발전, 33:6840-6851, 2020.[17] Jonathan Ho 및 Tim Salimans. 분류자 없는 확산 안내. arXiv 사전 인쇄본 arXiv:2207.12598, 2022.[18] Jonathan Ho, Tim Salimans, Alexey Gritsenko, William Chan, Mohammad Norouzi, David J Fleet. 비디오 확산 모델. arXiv 사전 인쇄본 arXiv:2204.03458, 2022.[19] Aapo Hyvärinen 및 Peter Dayan. 점수 매칭을 통한 비정규화된 통계적 모델 추정. Journal of Machine Learning Research, 6(4), 2005.[20] Boris Ivanovic, Karen Leung, Edward Schmerling, Marco Pavone. 궤적 예측을 위한 다중 모드 딥 생성 모델: 조건부 변형 자동 인코더 접근 방식. IEEE Robotics and Automation Letters, 6(2):295– 302, 2020.[21] Michael Janner, Yilun Du, Joshua Tenenbaum, Sergey Levine. 유연한 행동 합성을 위한 확산을 통한 계획. 기계 학습 국제 컨퍼런스, 2022.[22] Zahra Kadkhodaie, Eero Simoncelli. 잡음 제거기에서 사전 암시적을 사용하는 선형 역 문제에 대한 확률적 솔루션. 신경 정보 처리 시스템의 발전, 34:13242-13254, 2021.[23] Tero Karras, Miika Aittala, Timo Aila, Samuli Laine. 확산 기반 생성 모델의 설계 공간 설명. arXiv 사전 인쇄본 arXiv:2206.00364, 2022. 2, 3,[24] Bahjat Kawar, Michael Elad, Stefano Ermon, Jiaming Song. 잡음 제거 확산 복원 모델. arXiv 사전 인쇄본 arXiv:2201.11793, 2022. 2,[25] Siddhesh Khandelwal, William Qi, Jagjeet Singh, Andrew Hartnett, Deva Ramanan. 자율 주행을 위한 가상 모션 예측. arXiv 사전 인쇄본 arXiv:2008.10587, 2020.[26] Jiachen Li, Fan Yang, Hengbo Ma, Srikanth Malla, Masayoshi Tomizuka, Chiho Choi. Rain: 모션 예측을 위한 강화된 하이브리드 주의 추론 네트워크. IEEE/CVF 국제 컴퓨터 비전 컨퍼런스 논문집, 16096–16106쪽, 2021.[27] Wenjie Luo, Cheolho Park, Andre Cornman, Benjamin Sapp, Dragomir Anguelov. Jfp: 자율 주행을 위한 대화형 다중 에이전트 모델링을 통한 공동 미래 예측. Conf. On Robot Learning, 2022. 3,[28] Yecheng Jason Ma, Jeevana Priya Inala, Dinesh Jayaraman, Osbert Bastani. 흐름 기반 궤적 예측을 정규화하기 위한 다양한 샘플링. arXiv 사전 인쇄본 arXiv:2011.15084, 7(8), 2020.[29] Wei Mao, Miaomiao Liu, Mathieu Salzmann. 다양한 인간 동작 예측을 위한 부드러운 포즈 시퀀스 생성. IEEE/CVF 국제 컴퓨터 비전 컨퍼런스 회의록, 13309-13318페이지, 2021.[30] Xiaoyu Mo, Zhiyu Huang, Chen Lv. 이기종 에지 강화 그래프 어텐션 네트워크를 사용한 다중 모달 상호 작용 에이전트 궤적 예측. 자율 주행 워크숍, CVPR, 6권, 7페이지, 2021.[31] Nigamaa Nayakanti, Rami Al-Rfou, Aurick Zhou, Kratarth Goel, Khaled S Refaat, Benjamin Sapp. Wayformer: 간단하고 효율적인 주의 네트워크를 통한 동작 예측. arXiv 사전 인쇄본 arXiv:2207.05844, 2022. 3, 4,[32] Jiquan Ngiam, Benjamin Caine, Vijay Vasudevan, Zhengdong Zhang, Hao-Tien Lewis Chiang, Jeffrey Ling, Rebecca Roelofs, Alex Bewley, Chenxi Liu, Ashish Venugopal, David Weiss, Benjamin Sapp, Zhifeng Chen, Jonathon Shlens. 장면 변환기: 행동 예측 및 계획을 위한 통합 멀티태스크 모델. CoRR, abs/2106.08417, 2021. 3,[33] Alexander Quinn Nichol 및 Prafulla Dhariwal. 개선된 노이즈 제거 확산 확률 모델. 국제 기계 학습 컨퍼런스, 8162-8171페이지. PMLR, 2021.[34] 오근섭 및 펭 휘이. Cvae-h: 자율 주행을 위한 하이퍼네트워크 및 궤적 예측을 통한 변형 자동 인코더 조건화. arXiv 사전 인쇄본 arXiv:2201.09874, 2022.[35] 벤 풀, 아자이 자인, 조나단 T 배런 및 벤 밀든홀. Dreamfusion: 2D 확산을 사용한 텍스트-3D. arXiv 사전 인쇄본 arXiv:2209.14988, 2022.[36] 아디티아 라메시, 프라풀라 다리왈, 알렉스 니콜, 케이시 추 및 마크 첸. 클립 잠재성을 사용한 계층적 텍스트 조건부 이미지 생성. arXiv 사전 인쇄본 arXiv:2204.06125, 2022.[37] Robin Rombach, Andreas Blattmann, Dominik Lorenz, Patrick Esser, Björn Ommer. 잠재 확산 모델을 사용한 고해상도 이미지 합성. IEEE/CVF 컴퓨터 비전 및 패턴 인식 컨퍼런스 회의록, 10684-10695페이지, 2022. 2,[38] Saeed Saadatnejad, Ali Rasekh, Mohammadreza Mofayezi, Yasamin Medghalchi, Sara Rajabzadeh, Taylor Mordan, Alexandre Alahi. 야생에서 3D 인간 포즈 예측을 위한 일반적인 확산 기반 접근 방식. arXiv 사전 인쇄본 arXiv:2210.05669, 2022.[39] Chitwan Saharia, William Chan, Saurabh Saxena, Lala Li, Jay Whang, Emily Denton, Seyed Kamyar Seyed Ghasemipour, Burcu Karagol Ayan, S Sara Mahdavi, Rapha Gontijo Lopes, et al. 심층적 언어 이해를 통한 사실적인 텍스트-이미지 확산 모델. arXiv 사전 인쇄본 arXiv:2205.11487, 2022.[40] Benjamin Sapp, Yuning Chai, Mayank Bansal, Dragomir Anguelov. 다중 경로: 행동 예측을 위한 다중 확률적 앵커 궤적 가설. 로봇 학습 컨퍼런스, 86-99페이지. PMLR, 2020.[41] Christoph Schöller 및 Alois Knoll. Flomo: 흐름 정규화를 통한 추적 가능한 동작 예측. 2021년 IEEE/RSJ 지능형 로봇 및 시스템 국제 컨퍼런스(IROS), 7977-7984쪽. IEEE, 2021.[42] Haoran Song, Wenchao Ding, Yuxuan Chen, Shaojie Shen, Michael Yu Wang, Qifeng Chen. Pip: 자율 주행을 위한 Planninginformed trajectory prediction. 유럽 컴퓨터 비전 컨퍼런스, 598-614쪽. Springer, 2020.[43] Jiaming Song, Chenlin Meng, Stefano Ermon. 확산 암시적 모델의 노이즈 제거. arXiv 사전 인쇄본 arXiv:2010.02502, 2020. 2,[44] Yang Song, Jascha Sohl-Dickstein, Diederik P Kingma, Abhishek Kumar, Stefano Ermon, Ben Poole. 확률적 미분 방정식을 통한 점수 기반 생성 모델링. arXiv 사전 인쇄본 arXiv:2011.13456, 2020. 2,[45] Qiao Sun, Xin Huang, Junru Gu, Brian C Williams, and Hang Zhao. M2i: 요인화된 주변 궤적 예측에서 상호작용 예측으로. arXiv 사전 인쇄본 arXiv:2202.11884, 2022. 3,[46] Charlie Tang and Russ R Salakhutdinov. 다중 미래 예측. NeurIPS에 게재됨. 2019.[47] Ekaterina I. Tolstaya, Reza Mahjourian, Carlton Downey, Balakrishnan Varadarajan, Benjamin Sapp, and Dragomir Anguelov. 조건부 행동 예측을 통해 운전자 상호작용 식별. IEEE 국제 로봇 및 자동화 컨퍼런스, ICRA 2021, 중국 시안, 2021년 5월-6월 5일, 3473-3479페이지. IEEE, 2021.[48] Balakrishnan Varadarajan, Ahmed Hefny, Avikalp Srivastava, Khaled S Refaat, Nigamaa Nayakanti, Andre Cornman, Kan Chen, Bertrand Douillard, Chi Pang Lam, Dragomir Anguelov, et al. Multipath++: 행동 예측을 위한 효율적인 정보 융합 및 궤적 집계. arXiv 사전 인쇄본 arXiv:2111.14973, 2021. 3, 6,[49] Ruihan Yang, Prakhar Srivastava, Stephan Mandt. 비디오 생성을 위한 확산 확률 모델링. arXiv 사전 인쇄본 arXiv:2203.09481, 2022.[50] Wenyuan Zeng, Wenjie Luo, Simon Suo, Abbas Sadat, Bin Yang, Sergio Casas, Raquel Urtasun. 종단 간 해석 가능 신경 동작 플래너. IEEE/CVF 컴퓨터 비전 및 패턴 인식 컨퍼런스 회의록, 8660-8669페이지, 2019.[51] Wenyuan Zeng, Shenlong Wang, Renjie Liao, Yun Chen, Bin Yang, Raquel Urtasun. Dsdnet: 심층 구조 자율 주행 네트워크. 유럽 컴퓨터 비전 컨퍼런스, 156-172페이지. Springer, 2020.[52] Mingyuan Zhang, Zhongang Cai, Liang Pan, Fangzhou Hong, Xinying Guo, Lei Yang, Ziwei Liu. Motiondiffuse: 확산 모델을 사용한 텍스트 기반 인간 동작 생성. arXiv 사전 인쇄본 arXiv:2208.15001, 2022.[53] Ziyuan Zhong, Davis Rempe, Danfei Xu, Yuxiao Chen, Sushant Veer, Tong Che, Baishakhi Ray 및 Marco Pavone. 제어 가능한 교통 시뮬레이션을 위한 유도 조건부 확산. arXiv 사전 인쇄본 arXiv:2210.17366, 2022. 3,MotionDiffuser: 확산을 사용한 제어 가능한 다중 에이전트 동작 예측 Andre Cornman* Cheolho Park Yin Zhou Dragomir Anguelov * 동등한 기여 Chiyu &quot;Max&quot; Jiang* Ben Sapp Waymo LLC 제약 조건 없음 제약 조건 NMS 이전 NMS 이후 NMS 이전 NMS 이후 1. 추가 시각화 arXiv:2306.03083v1 [cs.RO] 6월 5일 KKKK AR AKKEKK CC KEK ☐ KK AR KKKK ☐ K AR K Π NMS 이전 四 B 제약 조건 없음A NMS 이후 NMS 이전 KKK 제약 조건 AA K NMSA 이후 KK AA E 昌 NMS 이전 제약 조건 없음 NMS 이후 K 추석 K NMS 이전 KKK 제약 조건 B 추석明 Post-NMS KD K 수요일 KKKKK 2. 구현 세부 정보 MotionDiffuser는 2 × 106 학습 단계에 대해 32개 TPU 샤드를 사용하여 Waymo Open Motion Dataset에서 학습됩니다. 가중치 감소 계수가 0.03인 ADAMW 옵티마이저 [?]를 사용합니다. 학습률은 104개 워밍업 단계와 선형 학습률 감소를 사용하여 5 * 10-4로 설정됩니다. MotionDiffuser는 각각 256의 숨겨진 크기를 가진 128개 잠재 임베딩이 있는 Wayformer [?] 인코더 백본을 사용합니다. Wayformer 인코더는 에이전트 중심이므로 각 에이전트의 위치와 방향(에고 차량 기준)을 해당 컨텍스트 벡터에 추가합니다. 당사의 트랜스포머 디노이저 아키텍처는 4개 층의 셀프 어텐션 및 크로스 어텐션 블록을 사용합니다. 각 어텐션 층의 숨겨진 크기는 256이고 중간 크기는 1024입니다. 모든 트랜스포머 층에서 ReLU 활성화가 사용됩니다. 우리는 128개의 랜덤 푸리에 특징을 사용하여 노이즈 레벨을 내장합니다.N 우리는 훈련 및 추론 중에 N개의 랜덤 노이즈 벡터를 유연하게 노이즈 제거할 수 있습니다.우리는 훈련 중에 N = 128을 사용하고 추론 중에 256을 사용합니다(클러스터링을 적용하기 전).= 3. 네트워크 사전 조정 우리는 [?]의 네트워크 사전 조정 프레임워크를 따르며, 이는 노이즈 제거기 De를 다음과 같이 정의합니다.De(x; c, σ) = Cskip(0)x + Cout(0) Fo(Cin(σ)x; C, Cnoise(σ)) Cin(σ)는 Fo에 대한 훈련 입력이 단위 분산을 갖도록 네트워크 입력을 조정합니다. Cin(σ) = 1/√√/02 +0% 데이터 V Cskip(σ)는 스킵 연결을 변조하고 다음과 같이 정의됩니다.Cskip(0) = 0 데이터/(0² +0% 데이터) Cout()은 네트워크 출력을 변조하고 다음과 같이 정의됩니다.(1) (2) (3) V데이터 (4) Cnoise(σ) = = lno (5) 모든 실험에서 σ 데이터 = 0.5로 설정했습니다. Cout(σ) = 0·0data/ 마지막으로 Cnoise(σ)는 노이즈 레벨을 조정하며 다음과 같이 정의됩니다.4. 추론 지연 시간 우리는 표 1에 다양한 샘플링 단계 T에 대한 모델의 추론 지연 시간을 보고합니다.배치 크기가 1인 단일 VGPU를 사용합니다.방법 지연 시간(ms) minSADE(↓) minSFDE(↓) SMissRate(↓) Ours(T = 8) 101.0.2.0.Ours(T == 16) 203.0.1.0.Ours(T32) 408.0.1.0.표 1. WOMD 대화형 검증 분할에 대한 모델 추론 지연 시간 대 품질.
