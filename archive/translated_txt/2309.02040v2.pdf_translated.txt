--- ABSTRACT ---
역설계는 목표 결과를 실행하기 위해 목적 함수의 입력을 최적화하는 문제를 말합니다. 많은 실제 엔지니어링 문제에서 목적 함수는 시스템 상태가 시간이 지남에 따라 어떻게 진화할지 예측하는 시뮬레이터 형태를 띠며, 설계 과제는 목표 결과로 이어지는 초기 조건을 최적화하는 것입니다. 학습된 시뮬레이션의 최근 개발은 그래프 신경망(GNN)을 사용하여 시뮬레이터 역학의 정확하고 효율적이며 미분 가능한 추정을 수행하고 기울기 또는 샘플링 기반 최적화 절차를 통해 고품질 설계 최적화를 지원할 수 있음을 보여주었습니다. 그러나 처음부터 설계를 최적화하려면 많은 비용이 많이 드는 모델 쿼리가 필요하며 이러한 절차는 비볼록 또는 고차원 문제에서 기본적인 실패를 보입니다. 이 작업에서 우리는 잡음 제거 확산 모델(DDM)을 사용하여 역설계 문제를 효율적으로 해결하는 방법을 보여주고 효율성을 더욱 개선하기 위한 입자 샘플링 알고리즘을 제안합니다. 우리는 여러 유체 역학 설계 과제에 대한 실험을 수행했으며, 우리의 접근 방식이 표준 기술에 비해 시뮬레이터에 대한 호출 수를 상당히 줄인다는 것을 발견했습니다. 1.
--- METHOD ---
주어진 작업 사양 c에 대해 최적화하려는 설계(x)의 대상 분포가 wrtx입니다.표기법을 간소화하기 위해 종속성을 강조하지 않습니다.설계 생성 및 평가 확산 생성 모델 확산 생성 역설계 G 학습된 시뮬레이터 x,~ N(0,1) x ~π(x) FM Ꮎ IC Ꮎ E + b 사전 최적화된 설계에서 학습된 확산 모델 역확산 x G 확산 C 보상을 위한 설계 샘플 최적화 조건부 샘플링 E ... 가이드 샘플링 에너지 함수 EE VE 그림 1. (a) Orc, 에너지 함수 매개변수 OE 및 학습된 GNN 역학 모델 fм에 의해 제어되는 초기 조건이 주어지면 확산 모델의 설계 샘플 x에 비용 E(x)가 할당됩니다.(b) DDM 학습의 개략도 (c) 기울기 VE 및 조건부 세트(0E 및 E)는 에너지 및 조건부 안내, 각각 Ton c에 정보를 제공합니다. 이 분포는 매우 비볼록한 비용 지형이 효율적인 최적화를 방해할 수 있으므로 처리하기 어려운 객체입니다. 기존 데이터에서 학습한 사전 분포 p(x)의 형태로 &#39;합리적인&#39; 설계에 대한 사전 지식을 포착할 수 있습니다. 사전이 주어지면 분포 ñ(x) xp(x)π(x)(1)에서 샘플링할 수 있습니다. 이 작업에서는 가이드 샘플링을 사용한 확산 방법을 사용하여 이를 달성합니다. 설계는 이후 사전 학습된 GNN 시뮬레이터와 보상 함수(Allen et al., 2022; Pfaff et al., 2021; Sanchez-Gonzalez et al., 2020)로 구성된 학습된 전방 모델에 의해 평가됩니다(부록 A 참조). E : X ↔ R은 학습된 시뮬레이터에서 특정 작업 c에 대한 설계 x Є X의 비용(또는 &quot;에너지&quot;)입니다(단순화를 위해 E의 c에 대한 종속성은 생략). 설계 π(x)의 목표 분포는 볼츠만 분포 π(x)에 의해 정의됩니다. =:== exp (− E(x)), ZT (2) 여기서 Z는 알려지지 않은 정규화 상수를 나타내고 &amp;는 온도 매개변수를 나타냅니다. T →0일 때 이 분포는 모드, 즉 비용 Ec(x)에 대한 최적 설계 세트에 집중합니다. 7(x)에서 샘플링하는 직접적인 방법은 비용이 많이 드는 마르코프 체인 몬테카를로 기술이나 역 KL 기준을 최소화하는 변분 방법에 의존합니다. 우리는 이전 최적화 시도에서 확산 모델에 의해 학습된 데이터 기반 사전에 의존할 것입니다. 우리는 Adam(Kingma &amp; Ba, 2015) 또는 CEM(Rubinstein, 1999)을 사용하여 x를 최적화하는 다양한 작업 매개변수화 c에 대한 설계의 최적화 궤적을 수집합니다. 설계의 여러 전체 최적화 궤적이 생성 모델의 학습 세트에 포함되어 다양한 설계 품질을 제공합니다. 이러한 최적화 궤적은 유체 아래의 평평한 도구로 초기화되며(그림 5 참조), 무작위로 초기화된 도구보다 성공적인 도구로 쉽게 형성될 수 있습니다. 나중에 DDM의 성능을 Adam 및 CEM과 비교할 때 Adam 및 CEM에 무작위로 초기화된 도구를 사용하게 되는데, 이는 훨씬 더 어렵습니다. 2.1. 확산 생성 모델 DDM을 사용하여 p(x)를 맞춥니다(Ho et al., 2020; Song et al., 2020b). 핵심 아이디어는 dxt == (3) -Btxt dt + √2ẞtdwt로 정의된 확산 과정(xt) tε [0,1]에 의해 포착된 학습 데이터 x0~ p를 사용하여 초기화하는 것입니다. 여기서 (wt)te[0,1]은 Wiener 과정을 나타냅니다. (3) 하에서 x+의 분포를 Pt(x)로 표시합니다. 충분히 큰 ẞt의 경우 P1(x)N(x; 0, 1). (3)의 시간 역전은 dxt = −ßt[xt +2Vx log pt(xt)]dt + √√2ßw, (4) =를 만족합니다. 여기서 (w₁¯ )te[0,1]은 시간이 t = 1에서 t 0으로 역방향으로 흐를 때의 위너 프로세스이고 dt는 무한소 음의 시간 단계입니다. x1 P1을 사용하여 (4)를 초기화하면 x0 ~ p를 얻습니다. 실제로 생성 모델은 (4)의 근사치를 샘플링하고 p1(x)를 N(x; 0, I)로, 난제 점수 Vx log pt (x)를 se (x, t)로 대체하여 얻습니다. 점수 추정치 so (x, t)는 잡음 제거 점수 매칭을 통해 학습됩니다. 즉, Vlog Pt(x) √ √x log p(x+|xo)p(x0|x+)dxo라는 사실을 사용합니다. 여기서 p(x+|xo) N(xt; √√atxo, √√1 - α+I)는 (3)의 전이 밀도이고 (ẞs)se[0,t]의 함수입니다(Song et al., 2020b). 점수가 Vlog pt(x) = −E[e|x₁ = x]/√√1 − αt를 만족하는 것은 다음과 같습니다. = = Ꮖ 확산 생성 역 설계 xt = √√α+x+ √√1 - αe. 그런 다음 L(0) = Exo~p,t~U(0,1),€~N(0,1)||€0(xt, t) — e||², (5) 알고리즘 1 기저 분포의 입자 최적화. 입력 에너지 함수 E, 확산 생성 모델 po, 온도 7, 노이즈 스케일 σ, 라운드 K. 2: S = {x} iid (0, 1)에 대해 So = 0, S₁ = 0 # t = 0 및 t = 1 샘플 세트 4: k{0... K}에 대해 do = x]. 6: 여기서 (x, t)는 E[ext를 추정하는 노이즈 제거기입니다. 점수 함수 se (x, t) ≈ Vx log pt (x)는 다음을 사용하여 얻습니다. (x, t) = €0 (x, t) - αt Eq. (7)의 역 ODE를 풀어 S에서 S = {x}₁를 계산합니다. So = So US, S₁ = S₁ US 정규화된 중요도 가중치 W = {w | wx exp (− E(x0)), xo € So} (6) 8: Set 5+1 = {{ } for Set S+1 = {} 앞으로 V는 달리 명시되지 않는 한 V를 참조합니다. (Song et al., 2020b)에서 개발한 상미분 방정식(ODE)을 사용하여 p(x)에서 샘플링할 수도 있습니다. = ~ = ~ t xt/√√at 및 ot √√1 – at/√√at를 정의하겠습니다. 그런 다음 x1을 N(0, 1)로 초기화하고 동등하게 N(0, a¹I)로 시간 α 10을 뒤로 풉니다. end for | $1 | wi δ (x) for ã² ~N(x; ã¹₁, o² I) return arg minЄSO E(x) then xo= dat = (t) €xt dot, (7) at xo는 p(x)의 근사 샘플입니다. 2.2. 대상 ~(x)에서 근사 샘플링 (1)에 정의된 ~(x)를 샘플링하려고 합니다. 여기서 p(x)는 확산 모델을 사용하여 샘플링할 수 있습니다. 다운스트림 최적화에 대해 서로 다른 이점을 가진 두 가지 가능한 샘플링 절차를 설명합니다. 에너지 가이드. it(at) = | i (20)p(+20)do이고 그래디언트가 Vlog(x) = Vlogpt(xt) + Vlogπt(x+)를 만족함을 관찰합니다. 여기서 πt(x+) = f(x0)p(x0| x+)dxo입니다. 우리는 근사 xt(x, t) = √√1 - α+€(x, t) √at (8) &quot;추정된 o&quot; Tt(2t) ≈ π(xt(x,t))로 만들어 이 항을 근사합니다. 이제 (6)과 항등성 V logπ(x) = −¯¯¹VE(x)에 의해 수정된 잡음 제거 벡터 Ĕø(xt, t) = €0 (xt, t) + \¯¯¯¹ √1 − α₁VE(â(x,t)), (9)로 역 샘플링 절차를 변경할 수 있습니다. 이는 하이퍼파라미터입니다. 에너지 안내에 대한 결과는 부록 E. 조건부 안내에서 미루겠습니다. 분류기 없는 안내(Ho &amp; Salimans, 2022)와 유사하게 비용(에너지) e와 작업 c에 대한 조건을 탐구합니다. 역 프로세스에서 수정된 노이즈 제거 벡터는 조건부 노이즈 제거기 Еф의 노이즈 제거 벡터와 비조건부 노이즈 제거기 Є Ĕ(xt, c, e,t) = (1 + \)€ (xt, c, e, t) — \ep(x, t), (10)의 조합으로 나타납니다. 여기서 €는 최적화 궤적에서 c와 비용 e를 조건으로 학습합니다. 우리의
--- EXPERIMENT ---
s는 여러 유체 역학 설계 과제에 대해 논의하고, 우리의 접근 방식이 표준 기술에 비해 시뮬레이터 호출 횟수를 상당히 줄인다는 것을 발견했습니다. 1. 서론 우리 삶의 방식에 대한 상당한 개선은 엔지니어링 과제에 대한 솔루션을 고안하는 데 달려 있으며, 머신 러닝(ML)이 발전하면서 긍정적인 현실 세계에 영향을 미칠 것으로 예상되는 분야입니다. 이러한 문제 중 다수는 바람직한 물리적 역학을 발생시키는 객체를 설계하는 것으로 공식화할 수 있습니다(예: 공기 역학적 자동차 또는 방수 용기 설계). 여기서 우리는 ML을 사용하여 &#39;Max Planck Institute for Intelligent Systems, Tübingen, Germany Google DeepMind, London, UK 3 Columbia University, New York, NY. 연락처: Marin Vlastelica<marin.vlastelica@tue.mpg.de> , 킴벌리 스타첸펠드<stachenfeld@deepmind.com> . 사전 인쇄본. 저작권 2023 저자. 이 설계 프로세스는 동역학의 전방 모델과 설계 공간에 대한 분포를 모두 학습하여 수행됩니다. ML 가속 설계에 대한 이전 접근 방식은 최적화를 위한 미분 가능한 전방 모델로 신경망을 사용했습니다(Challapalli et al., 2021; Christensen et al., 2020; GómezBombarelli et al., 2018). 우리는 전방 모델이 유체 역학을 시뮬레이션하도록 훈련된 GNN의 특정 형태를 취하는 작업을 기반으로 합니다(Allen et al., 2022). 학습된 모델은 미분 가능하므로 기울기 기반 접근 방식(이러한 접근 방식은 0 또는 노이즈가 있는 기울기와 국소 최소값에 어려움을 겪지만) 또는 샘플링 기반 접근 방식(이러한 접근 방식은 고차원 설계 공간에서는 잘 작동하지 않음)으로 설계 최적화를 수행할 수 있습니다. 두 접근 방식 모두 전방 모델에 대한 여러 개의 값비싼 호출이 필요한 경우가 많습니다. 그러나 생성 모델을 사용하여 그럴듯한 설계를 제안하여 필요한 호출 수를 줄일 수 있습니다(Forte et al., 2022; Zheng et al., 2020; Kumar et al., 2020). 이 연구에서 우리는 학습된 데이터 기반 사전에서 정보를 얻은 대상 분포에서 샘플링하여 설계를 최적화하기 위해 DDM을 사용합니다. DDM은 이미지 생성에서 놀라운 결과를 얻었으며(Song et al., 2020a;b; Karras et al., 2022; Ho et al., 2020), 그 이후로 순차적 의사 결정 및 강화 학습(Janner et al., 2022; Ajay et al., 2022), 매니폴드(De Bortoli et al., 2022) 또는 제약 최적화 공식(Graikos et al., 2022)에서 효율적인 플래너를 학습하는 데 사용되었습니다. 우리의 주요 기여는 물리적 문제 해결 설정에서 DDM을 고려하는 것입니다. 우리는 이러한 모델을 연속 샘플링 절차와 결합하면 CEM 및 Adam과 같은 기성품 최적화 도구보다 훨씬 빠르게 설계 문제를 해결할 수 있다는 것을 발견했습니다. 이는 입자 샘플링 방식을 사용하여 확산 모델의 기본 분포를 업데이트함으로써 더욱 개선될 수 있으며, 학습된 모델을 사용하여 저렴한 평가(몇 가지 ODE 단계)를 통해 바닐라 샘플링 절차에 비해 더 나은 설계를 도출합니다. 우리는 입자 유체 설계 환경에서 여러 실험에 대한 결과를 검증합니다. 2. 방법 어떤 작업 사양 c가 주어지면, 최적화하고자 하는 설계(x)의 목표 분포가 wrtx입니다.표기법을 간소화하기 위해, a의 종속성을 강조하지 않습니다.설계 생성 및 평가 확산 생성 모델 확산 생성 역설계 G 학습된 시뮬레이터 x,~ N(0,1) x ~π(x) FM Ꮎ IC Ꮎ E + b 사전 최적화된 설계로 학습된 확산 모델 역확산 x G 확산 C 보상을 위한 설계 샘플 최적화 조건부 샘플링 E ... 가이드 샘플링 에너지 함수 EE VE 그림 1. (a) Orc, 에너지 함수 매개변수 OE 및 학습된 GNN 역학 모델 fм에 의해 지배되는 초기 조건이 주어지면 확산 모델의 설계 샘플 x에 비용 E(x)가 할당됩니다.(b) DDM 학습의 개략도 (c) 기울기 VE 및 조건부 세트(0E 및 E)는 에너지 및 조건부 안내, 각각 Ton c에 정보를 제공합니다. 이 분포는 매우 비볼록한 비용 지형이 효율적인 최적화를 방해할 수 있으므로 처리하기 어려운 객체입니다. 기존 데이터에서 학습한 사전 분포 p(x)의 형태로 &#39;합리적인&#39; 설계에 대한 사전 지식을 포착할 수 있습니다. 사전이 주어지면 분포 ñ(x) xp(x)π(x)(1)에서 샘플링할 수 있습니다. 이 작업에서는 가이드 샘플링을 사용한 확산 방법을 사용하여 이를 달성합니다. 설계는 이후 사전 학습된 GNN 시뮬레이터와 보상 함수(Allen et al., 2022; Pfaff et al., 2021; Sanchez-Gonzalez et al., 2020)로 구성된 학습된 전방 모델에 의해 평가됩니다(부록 A 참조). E : X ↔ R은 학습된 시뮬레이터에서 특정 작업 c에 대한 설계 x Є X의 비용(또는 &quot;에너지&quot;)입니다(단순화를 위해 E의 c에 대한 종속성은 생략). 설계 π(x)의 목표 분포는 볼츠만 분포 π(x)에 의해 정의됩니다. =:== exp (− E(x)), ZT (2) 여기서 Z는 알려지지 않은 정규화 상수를 나타내고 &amp;는 온도 매개변수를 나타냅니다. T →0일 때 이 분포는 모드, 즉 비용 Ec(x)에 대한 최적 설계 세트에 집중합니다. 7(x)에서 샘플링하는 직접적인 방법은 비용이 많이 드는 마르코프 체인 몬테카를로 기술이나 역 KL 기준을 최소화하는 변분 방법에 의존합니다. 우리는 이전 최적화 시도에서 확산 모델에 의해 학습된 데이터 기반 사전에 의존할 것입니다. 우리는 Adam(Kingma &amp; Ba, 2015) 또는 CEM(Rubinstein, 1999)을 사용하여 x를 최적화하는 다양한 작업 매개변수화 c에 대한 설계의 최적화 궤적을 수집합니다. 설계의 여러 전체 최적화 궤적이 생성 모델의 학습 세트에 포함되어 다양한 설계 품질을 제공합니다. 이러한 최적화 궤적은 유체 아래의 평평한 도구로 초기화되며(그림 5 참조), 무작위로 초기화된 도구보다 성공적인 도구로 쉽게 형성될 수 있습니다. 나중에 DDM의 성능을 Adam 및 CEM과 비교할 때 Adam 및 CEM에 무작위로 초기화된 도구를 사용하게 되는데, 이는 훨씬 더 어렵습니다. 2.1. 확산 생성 모델 DDM을 사용하여 p(x)를 맞춥니다(Ho et al., 2020; Song et al., 2020b). 핵심 아이디어는 dxt == (3) -Btxt dt + √2ẞtdwt로 정의된 확산 과정(xt) tε [0,1]에 의해 포착된 학습 데이터 x0~ p를 사용하여 초기화하는 것입니다. 여기서 (wt)te[0,1]은 Wiener 과정을 나타냅니다. (3) 하에서 x+의 분포를 Pt(x)로 표시합니다. 충분히 큰 ẞt의 경우 P1(x)N(x; 0, 1). (3)의 시간 역전은 dxt = −ßt[xt +2Vx log pt(xt)]dt + √√2ßw, (4) =를 만족합니다. 여기서 (w₁¯ )te[0,1]은 시간이 t = 1에서 t 0으로 역방향으로 흐를 때의 위너 프로세스이고 dt는 무한소 음의 시간 단계입니다. x1 P1을 사용하여 (4)를 초기화하면 x0 ~ p를 얻습니다. 실제로 생성 모델은 (4)의 근사치를 샘플링하고 p1(x)를 N(x; 0, I)로, 난제 점수 Vx log pt (x)를 se (x, t)로 대체하여 얻습니다. 점수 추정치 so (x, t)는 잡음 제거 점수 매칭을 통해 학습됩니다. 즉, Vlog Pt(x) √ √x log p(x+|xo)p(x0|x+)dxo라는 사실을 사용합니다. 여기서 p(x+|xo) N(xt; √√atxo, √√1 - α+I)는 (3)의 전이 밀도이고 (ẞs)se[0,t]의 함수입니다(Song et al., 2020b). 점수가 Vlog pt(x) = −E[e|x₁ = x]/√√1 − αt를 만족하는 것은 다음과 같습니다. = = Ꮖ 확산 생성 역 설계 xt = √√α+x+ √√1 - αe. 그런 다음 L(0) = Exo~p,t~U(0,1),€~N(0,1)||€0(xt, t) — e||², (5) 알고리즘 1 기저 분포의 입자 최적화. 입력 에너지 함수 E, 확산 생성 모델 po, 온도 7, 노이즈 스케일 σ, 라운드 K. 2: S = {x} iid (0, 1)에 대해 So = 0, S₁ = 0 # t = 0 및 t = 1 샘플 세트 4: k{0... K}에 대해 do = x]. 6: 여기서 (x, t)는 E[ext를 추정하는 노이즈 제거기입니다. 점수 함수 se (x, t) ≈ Vx log pt (x)는 다음을 사용하여 얻습니다. (x, t) = €0 (x, t) - αt Eq. (7)의 역 ODE를 풀어 S에서 S = {x}₁를 계산합니다. So = So US, S₁ = S₁ US 정규화된 중요도 가중치 W = {w | wx exp (− E(x0)), xo € So} (6) 8: Set 5+1 = {{ } for Set S+1 = {} 앞으로 V는 달리 명시되지 않는 한 V를 참조합니다. (Song et al., 2020b)에서 개발한 상미분 방정식(ODE)을 사용하여 p(x)에서 샘플링할 수도 있습니다. = ~ = ~ t xt/√√at 및 ot √√1 – at/√√at를 정의하겠습니다. 그런 다음 x1을 N(0, 1)로 초기화하고 동등하게 N(0, a¹I)로 시간 α 10을 뒤로 풉니다. end for | $1 | wi δ (x) for ã² ~N(x; ã¹₁, o² I) return arg minЄSO E(x) then xo= dat = (t) €xt dot, (7) at xo는 p(x)의 근사 샘플입니다. 2.2. 타겟 ~(x)에서 근사 샘플링 (1)에 정의된 ~(x)를 샘플링하려고 합니다. 여기서 p(x)는 확산 모델을 사용하여 샘플링할 수 있습니다. 다운스트림 최적화를 위해 서로 다른 이점을 가진 두 가지 가능한 샘플링 절차를 설명합니다. 에너지 가이드. it(at) = | i (20)p(+20)do이고 그래디언트가 Vlog(x) = Vlogpt(xt) + Vlogπt(x+)를 만족함을 관찰하세요. 여기서 πt(x+) = f(x0)p(x0| x+)dxo입니다. 우리는 근사 xt(x, t) = √√1 - α+€(x, t) √at (8) &quot;추정된 o&quot; Tt(2t) ≈ π(xt(x,t))로 만들어 이 항을 근사합니다. 이제 (6)과 항등성 V logπ(x) = −¯¯¹VE(x)에 의해 수정된 잡음 제거 벡터 Ĕø(xt, t) = €0 (xt, t) + \¯¯¯¹ √1 − α₁VE(â(x,t)), (9)로 역 샘플링 절차를 변경할 수 있습니다. 이는 하이퍼파라미터입니다. 에너지 안내에 대한 결과는 부록 E. 조건부 안내에서 보류합니다. 분류기 없는 안내(Ho &amp; Salimans, 2022)와 유사하게 비용(에너지) e와 작업 c에 대한 조건을 탐구합니다. 역 프로세스에서 수정된 노이즈 제거 벡터는 조건부 노이즈 제거기 Еф의 노이즈 제거 벡터와 무조건부 노이즈 제거기 Є Ĕ(xt, c, e, t) = (1 + \)€ (xt, c, e, t) — \ep(x, t), (10)의 조합으로 나타납니다. 여기서 €는 최적화 궤적에서 c와 비용 e를 조건으로 학습합니다. 실험에서는 유체 입자에 대한 설계 비용 백분위수와 목표 목적지 OE를 포함하도록 c를 선택합니다(그림 1c). 2.3. 입자 샘플링을 통한 수정된 기본 분포 생성 프로세스는 시간 t =에서 N(x; 0, 1) ≈ p₁(x)로 샘플을 초기화합니다. 하위 섹션 2.2의 수정을 포함한 역 프로세스는 t = 0에서 7(x)의 근사 샘플을 제공합니다. 그러나 근사 비용 함수로 근사 노이즈 제거 모델의 ODE를 근사적으로 풀기 때문에 이는 E¹에 대한 샘플의 품질에 영향을 미칩니다. 또한 N(x; 0, 1)의 &quot;불량&quot; 샘플은 가이드 샘플링으로 수정하기 어렵습니다. 이를 완화하기 위해 N(x; 0, I)의 샘플을 사용하여 7(x)의 역방향 프로세스를 시작하는 대신, 몇 단계 역방향 프로세스에서 파생된 해당 {x}₁의 대략적인 추정치와 E로 평가하여 샘플 {x}}₁을 평가하는 다단계 입자 샘플링 방식을 사용합니다. 입자 절차는 7(x)의 가중 입자 근사에서 다시 샘플링한 다음 다시 샘플링된 입자를 섭동시키는 데 의존합니다(1 참조). 이 휴리스틱은 π의 샘플을 제공하지 않지만 작업 전체에서 더 낮은 에너지 샘플의 샘플을 제공한다는 것을 발견했습니다. 그러나 k 라운드 각각에 N개의 샘플이 있는 경우 여전히 E의 O(Nk) 평가가 필요하며, 이는 E의 선택에 따라 엄청나게 비쌀 수 있습니다.¹ 이상적으로는 테스트 시간에 기준 진실 역학 모델로 샘플을 평가해야 하지만, 프로젝트의 시간 제약으로 인해 근사 GNN 모델을 사용했습니다. 비용 ---- 이동 없음 비용 이동이 있는 확산 생성 역설계 Diff CEM Adam 600# 쿼리 400 600# 쿼리 그림 2. 각도 최적화 작업에서 다양한 최적화 방법의 성능. 확산 생성 모델에는 적은 수의 모델 쿼리가 필요한 반면, Adam에는 비교적 많은 값비싼 모델 쿼리가 필요합니다. 3. 실험 다양한 복잡도의 여러 작업이 있는 2D 유체 입자 환경에서 접근 방식을 평가합니다. 이 모든 작업은 유체 입자가 비용 E를 최소화하는 장면 영역에 있도록 도구(그림 1a, 검은색 선)를 형성하는 것을 포함합니다(Allen et al., 2022). 기준선으로, 우리는 입자의 학습된 모델과 결합된 Adam 최적화기와 학습된 모델로 최적화하는 CEM 최적화기를 사용합니다. 모든 실험에서 우리는 간단한 MLP를 잡음 제거 모델로, GNN 입자 시뮬레이션 모델을 사용하여 샘플을 평가했습니다. 첫 번째 작업은 단일 물 입자 소스, c = : (x,y)로 지정된 바닥 위의 목표 위치, 목표 근처의 유체를 포함하도록 각도가 최적화된 16개 조인트가 있는 관절 도구가 있는 간단한 &quot;포함&quot; 작업입니다(Allen et al. (2022) 참조). 그림 2a에서 Adam 최적화기와 CEM 모두 작업을 최적화할 수 있음을 알 수 있습니다. 그러나 최적화 궤적에 대한 사전 분포를 학습하고 가이드 샘플링을 통해 최적화된 설계의 이전 사례를 사전으로 추출한 이점을 확인할 수 있으며, 분포 내에서 샘플링된 보이지 않는 작업에서 더 적은 샘플로 더 우수한 성능을 달성할 수 있습니다. 보상(-E) 설계 데이터 집합 비용 차단 효과 차단|x, y 이동 매개변수를 제어하는 매개변수를 도입하여 작업을 수정하면 Adam이 실패하는 것을 관찰할 수 있습니다. 이는 도구가 유체와 접촉하지 않는 이동 값이 많기 때문입니다(그림 2b 참조). 따라서 E에서 그래디언트 정보를 얻지 못합니다. 부록 C(그림 5)에서 보다 복잡한 작업에 대한 결과를 제공합니다. 전반적으로 이 접근 방식은 여러 유형의 설계 과제를 해결하고 장애물이 있을 때, 다중 모드 보상 함수에 대해, 여러 도구를 조정해야 할 때 효과적인 솔루션을 찾을 수 있습니다. 3.1. 데이터 집합 품질 영향 동일한 작업(일치), 다른 작업(비일치) 또는 작업 혼합(그림 3)을 최적화하는 CEM의 최적화 궤적에 대해 학습했을 때 모델이 조건부 지침에 따라 어떻게 수행되는지 분석했습니다. 두 작업은 &quot;포함&quot;(위에서 설명)과 &quot;램프&quot;(훨씬 아래쪽 모서리로 유체 운반)였습니다. 당연히 학습 데이터 세트의 설계와 현재 작업에 대한 솔루션 간의 격차는 성능에 상당한 영향을 미칩니다. 또한 생성된 c에 대해 특정 비용 수준을 초과하는 샘플을 필터링하여 설계 샘플의 품질을 제어합니다. 데이터 세트에서 불량 샘플을 삭제해도 특정 지점을 넘어서는 성능은 향상되지 않습니다. 데이터 세트에서 성능이 좋지 않은 일부 설계로 최상의 성능을 얻을 수 있습니다. 직관적으로, 이는 데이터 세트를 최적화된 설계의 작은 세트로 제한하면 설계 공간의 적용 범위가 좁아 분포 내 테스트 문제에도 일반화가 잘 되지 않기 때문이라고 생각합니다. 또한 일치하지 않는 작업의 최적화 궤적에서 샘플로 생성 모델을 학습하면 성능에 상당한 부정적인 영향을 미칩니다. 에너지 함수를 통해 작업에 대한 정보가 더 많이 제공되므로 에너지 안내가 조건부 안내와 동일한 전달 문제를 겪지 않을 것으로 예상합니다. 실제로 Adam 및 CEM 실행에서 p(x)에 맞는 데이터를 얻었으므로 확산이 더 효율적인 이유는 무엇일까요? 부록 B에서 이에 대해 설명합니다. 3.2. 기본 분포에서의 입자 최적화 또한 2.3절의 입자 탐색 계획을 사용하여 성능이 향상되었음을 관찰합니다(그림 4 참조). 가우스 ― PSBoth 매칭 불일치 그림 3. 생성 모델은 두 가지 작업인 매칭, 불일치 또는 둘 다에서 CEM 및 Adam 최적화 설계에서 생성된 설계의 데이터 집합에서 학습되었습니다. 학습 데이터 집합의 설계는 지정된 차단값 아래의 비용이 있도록 필터링되었습니다. -----# 샘플 그림 4. 가우스 기본 분포 대 입자 샘플링(PS). 확산 생성 역설계 그 이유는 함수 근사 때문이라고 가정합니다. 근사 점수를 다루고 있으므로 학습된 생성 모델이 최적값을 정확히 찾기 어렵기 때문에 샘플링 기반 탐색 접근 방식이 도움이 됩니다. E가 있는 샘플의 평가에는 샘플 x1에 대한 ODE를 풀어야 하므로 (8)의 관계를 활용하여 1단계 역 프로세스를 사용합니다. 결과적으로 샘플링을 선형화하면 입자 탐색이 개선될 것으로 예상할 수 있습니다. 4.
--- CONCLUSION ---
이 작업에서 우리는 E를 통해 정의된 대상 분포 π(x)의 높은 확률 영역에서 샘플링을 하려는 단순 역설계 작업에서 확산 생성 모델을 사용하는 이점을 보여주었고, 최적화 데이터에 액세스할 수 있었습니다. 우리는 에너지 함수가 GNN을 전개하는 것을 포함하는 에너지 기반 및 조건부 안내를 분석했습니다. 우리는 에너지 안내가 실행 가능한 옵션이지만 조건부 안내가 실제로 더 잘 작동하고 성능은 생성 모델의 훈련 데이터에 크게 좌우된다는 것을 발견했습니다. 마지막으로, 우리는 샘플의 품질을 개선하는 수단으로 기본 분포에서 입자 검색을 도입하고 여러 작업에서 이를 보여주었습니다. 5. 감사의 말 우리는 프로젝트에 대한 유익한 대화를 나눠준 Conor Durkan, Charlie Nash, George Papamakarios, Yulia Rubanova, Alvaro SanchezGonzalez에게 감사드리고 싶습니다. 또한 원고에 대한 의견을 주신 Alvaro Sanchez-Gonzalez에게도 감사드립니다. 참고문헌 Ajay, A., Du, Y., Gupta, A., Tenenbaum, JB, Jaakkola, TS, and Agrawal, P. Is conditional generative modeling all you need for decision-making? NeurIPSFoundation Models for Decision Making Workshop, 2022. Allen, KR, Lopez-Guevara, T., Stachenfeld, KL, Sanchez-Gonzalez, A., Battaglia, PW, Hamrick, JB, and Pfaff, T. Physical design using differentiable learned simulators. CORR, abs/2202.00728, 2022. URL https: //arxiv.org/abs/2202.00728. Battaglia, PW, Hamrick, JB, Bapst, V., SanchezGonzalez, A., Zambaldi, V., Malinowski, M., Tacchetti, A., Raposo, D., Santoro, A., Faulkner, R., et al. 관계적 귀납적 편향, 딥 러닝 및 그래프 네트워크. arXiv 사전 인쇄본 arXiv:1806.01261, 2018. Challapalli, A., Patel, D., 및 Li, G. 경량 메타물질을 최적화하기 위한 역 머신 러닝 프레임워크. Materials &amp; Design, 208:109937, 2021. Christensen, T., Loh, C., Picek, S., Jakobović, D., Jing, L., Fisher, S., Ceperic, V., Joannopoulos, JD, and Soljačić, M. 광자 결정을 위한 예측 및 생성적 기계 학습 모델. Nanophotonics, 9(13):4183-4192, 2020. De Bortoli, V., Mathieu, E., Hutchinson, M., Thornton, J., Teh, YW, and Doucet, A. 리만 점수 기반 생성 모델링. 신경 정보 처리 시스템의 발전, 2022. Forte, AE, Hanakata, PZ, Jin, L., Zari, E., Zareei, A., Fernandes, MC, Sumner, L., Alvarez, JT, and Bertoldi, K. 기계 학습을 통한 팽창형 연질 멤브레인의 역설계. Advanced Functional Materials, 32, 2022. Gilmer, J., Schoenholz, SS, Riley, PF, Vinyals, O., and Dahl, GE 양자 화학을 위한 신경 메시지 전달. International Conference on Machine Learning, 2017. Gómez-Bombarelli, R., Wei, JN, Duvenaud, D., Hernández-Lobato, J., Sánchez-Lengeling, B., Sheberla, D., Aguilera-Iparraguirre, J., Hirzel, TD, Adams, RP, Aspuru-Guzik, A. 분자의 데이터 중심 연속 표현을 사용한 자동 화학 설계. ACS Central Science, 4(2):268–276, 02 2018. Graikos, A., Malkin, N., Jojic, N., Samaras, D. 플러그 앤 플레이 사전 확률로서의 확산 모델. Advances in Neural Information Processing Systems, 2022. Ho, J., Salimans, T. 분류기 없는 확산 안내. arXiv 사전 인쇄본 arXiv:2207.12598, 2022. Ho, J., Jain, A., 및 Abbeel, P. 확산 확률적 모델의 노이즈 제거. 신경 정보 처리 시스템의 발전, 33:6840-6851, 2020. Janner, M., Du, Y., Tenenbaum, J., 및 Levine, S. 유연한 행동 합성을 위한 확산을 통한 계획. 기계 학습 국제 컨퍼런스, 2022. Karras, T., Aittala, M., Aila, T., 및 Laine, S. 확산 기반 생성 모델의 설계 공간 설명. 신경 정보 처리 시스템의 발전, 2022. Kingma, DP 및 Ba, J. Adam: 확률적 최적화를 위한 방법. International Conference on Learning Representations, 2015. Kumar, S., Tan, S., Zheng, L., Kochmann, DM 역설계 스피노도이드 메타물질. npj Computational Materials, 6:1-10, 2020. 확산 생성 역설계 Pfaff, T., Fortunato, M., Sanchez-Gonzalez, A., Battaglia, P. 그래프 네트워크를 사용한 메시 기반 시뮬레이션 학습. International Conference on Learning Representations, 2021. Rubinstein, R. 조합 및 연속 최적화를 위한 교차 엔트로피 방법. Methodology and Computing in Applied Probability, 1:127–190, 1999. Sanchez-Gonzalez, A., Godwin, J., Pfaff, T., Ying, R., Leskovec, J., Battaglia, P. 그래프 네트워크를 사용하여 복잡한 물리학을 시뮬레이션하는 방법 학습. In International Conference on Machine Learning, 2020. Song, J., Meng, C., and Ermon, S. Denoising diffusion implicit models. In International Conference on Learning Representations, 2020a. Song, Y., Sohl-Dickstein, J., Kingma, DP, Kumar, A., Ermon, S., and Poole, B. Score-based generative modeling through stochastic different equations. In International Conference on Learning Representations, 2020b. Zheng, L., Kumar, S., and Kochmann, DM Data-driven topology optimization of spinodoid metamaterials with seamlessly tunable anisotropy. ArXiv, abs/2012.15744, 2020. Diffusion Generative Inverse Design Appendix for Diffusion Generative Inverse Design A. Learned simulation with graph neural networks Allen et al.에서와 같이 (2022), 우리는 최근 개발된 MESHGNN 모델(Pfaff et al., 2021)에 의존하는데, 이는 입자 시뮬레이션을 위한 GNS 모델(SanchezGonzalez et al., 2020)의 확장입니다. MESHGNN은 에지와 노드 업데이트를 모두 수행하는 메시지 전달 그래프 신경망(GNN)의 한 유형이며(Battaglia et al., 2018; Gilmer et al., 2017) 물리 시뮬레이션을 위해 특별히 설계되었습니다. 우리는 그래프 GE G로 표현된 물리적 상태에 대한 시뮬레이션을 고려합니다. 상태 G = (V,E)는 에지 E로 연결된 노드 V를 가지며, 각 노드 v EV는 위치 u₁와 추가 동적 양 qv와 연관됩니다. 이 환경에서 각 노드는 입자에 해당하고 에지는 근접성에 따라 동적으로 계산됩니다. 모델이 훈련된 시뮬레이션 동역학은 시간 t에서 상태 Gt를 시간 t + At에서 상태 Gt+1에 매핑하는 &quot;기준 진실&quot; 시뮬레이터에 의해 제공됩니다. 시뮬레이터는 K 시간 단계에 걸쳐 반복적으로 적용되어 상태의 궤적 또는 &quot;롤아웃&quot;을 생성할 수 있으며, 이를 (Go,, GtK)로 표시합니다. GNN 모델 M은 이러한 궤적에서 학습되어 기준 진실 시뮬레이터 fs를 모방합니다. 학습된 시뮬레이터 fм은 유사하게 적용되어 롤아웃(Ĝto, Ĝt1, ..., GtK)을 생성할 수 있습니다. 여기서 Ğto Gto는 입력으로 주어진 초기 조건을 나타냅니다. = B. 결과에 대한 추가 논의 Adam 및 CEM 최적화 실행에서 생성된 데이터에서 확산 모델을 학습했고 평가 작업에서 Adam 및 CEM보다 개선된 점을 확인했습니다. 그 이유는 Adam과 CEM 모두 작업을 효율적으로 해결하기 위해 좋은 초기화가 필요하기 때문입니다. 예를 들어 그림 2에서 각 실행에 대해 Adam의 초기 설계는 환경 경계 내에서 각도와 x, y 좌표를 균일하게 샘플링했습니다. 이는 Allen et al.(2022)보다 Adam에서 평균적으로 더 나쁜 결과를 얻는 이유를 설명합니다. 마찬가지로 CEM의 경우 평균이 0이고 항등 공분산으로 초기화된 가우시안 샘플링 분포를 사용합니다. 초기 CEM 분포의 밀도 대부분이 최적 설계 근처에 집중되지 않은 경우 CEM은 이를 찾기 위해 많은 샘플이 필요합니다. 이와 대조적으로 확산 모델은 p(x)를 통해 설계의 양호한 초기화를 학습하며, 필요에 따라 가이드 샘플링을 통해 더욱 개선할 수 있습니다. C. 입자 환경 평가를 위해 Allen et al. (2022)에서와 유사한 유체 입자 시뮬레이션 환경을 고려합니다. 목표는 입자를 특정 구성으로 가져오는 &#39;도구&#39;를 설계하는 것입니다. 에너지를 방사형 기저 함수 E(x) = exp РЕР ||xx||| σ 초기 초기 조인트 각도 + 장애물이 있는 경우 이동 이중 모드 최적화 초기 최적화 다중 도구 최적화 + 초기 최적화 그림 5. 이 작업에서 고려하는 다양한 작업 c에 대해 생성된 가이드 확산 설계의 예. 초기 설계는 완전히 무작위로 시작하고 최적화된 설계는 작업을 해결합니다. 최적화된 조인트 각도 + 이동 최적화된 조인트 각도 확산 생성적 역설계 Adam CEM 확산 그림 6. 생성 모델을 사용하여 Adam, CEM 및 유도 확산으로 최적화된 설계의 예. 설계는 무작위 조인트 각도로 초기화됩니다. 표시된 각 설계는 시뮬레이터에 대한 1000번의 호출(그림 2의 x축 한계)을 통해 학습된 후 학습된 모델에서 평가된 해당 최적화 도구에 대한 최고 점수를 받은 설계입니다. 여기서 xt는 초기 조건 OIC와 매개변수 E를 사용하여 모델 fм으로 시뮬레이션을 롤아웃한 후의 입자 p의 좌표입니다. 에너지는 시뮬레이션의 마지막 상태에서 평가되므로 VE는 전체 시뮬레이션 롤아웃을 통해 전파되어야 합니다. 섹션 3에서 설명한 &quot;포함&quot; 환경 외에도, 가이드 확산에서 나온 설계로 평가하는 데 사용한 추가 예제 환경을 그림 5에서 볼 수 있습니다. 장애물이 있는 작업에서는 유체를 컵으로 가져오기 위해 설계가 상당히 정확해야 했습니다. 이는 조건부 안내 + 기본 분포에서 입자 샘플링이 있는 확산 모델에서 찾은 샘플이 이러한 유형의 설계를 정확하게 찾을 수 있다는 것을 강조하기 위한 것입니다. 비용 함수의 두 가지 가능한 최소값이 있는 이중 모드 작업의 경우 확산 모델로 두 모드를 모두 포착할 수 있습니다. 각 도구 조인트에 대해 x, y 이동 매개변수가 있고 도구가 분리되어 있는 설계의 차원을 늘리는 경우 확산 모델은 입자를 원하는 구성으로 가져오는 매개변수화를 도출할 수 있습니다. 그러나 결과 설계는 견고하고 매끄럽지 않아 7(x)에서 샘플링하는 역방향 프로세스를 안내하는 동안 제약 조건이나 정규화의 형태로 추가 수정이 필요함을 나타냅니다. D. 가이드 선택에 대한 논의 3장에서 볼 수 있듯이 보정된 기저 분포 샘플링을 사용한 조건부 가이드는 에너지 가이드보다 더 잘 작동하는 경향이 있습니다. 에너지 함수의 그래디언트를 평가하는 데 비용이 많이 드는 경우 에너지 없는 대안이 더 나을 수 있지만, 이를 위해서는 조건부 모델을 학습해야 합니다. 즉, 조건부 샘플에 대한 액세스가 필요합니다. E. 에너지 가이드 방정식(9)에 명시된 대로 에너지 함수의 그래디언트를 사용하는 것이 샘플을 가이드하는 실행 가능한 방법이라는 것을 발견했지만, 많은 비용이 많이 드는 평가라는 단서가 따릅니다(그림 8 참조). 가이드는 스케일링 인자 X의 선택에 매우 민감합니다. 실험에서 많은 통합 단계가 있는 더 작은 스케일링 인자가 더 나은 샘플 품질을 얻는다는 것을 발견했습니다. 직관적으로, 이는 기본 분포 p₁1(x)에서 &#39;나쁜&#39; 샘플을 유도하기 어렵다는 사실에서 비롯되며, 이는 알고리즘 1에서 도입한 입자 에너지 기반 샘플링 방식에 동기를 부여합니다. 또한 에너지의 기울기를 노이즈가 있는 마진 점수와 결합하는 방법을 살펴보았습니다. 그림 8에서 볼 수 있듯이 노이즈가 있는 마진과 동일한 표준을 갖도록 재조정하면 유도의 안정성이 향상되는 것을 발견했습니다. 여기서 에너지 기울기와 노이즈가 있는 마진 점수를 결합한 여러 함수를 분석하고 다음 변형을 살펴보았습니다. 확산 생성 역설계 ° --------0.0.0.0.1.linear - 선형 단위 선형 표준 CVX 그림 8. 노이즈가 있는 마진 점수에 대한 다양한 수정에 대한 유도 스케일(x축)에 따른 에너지 유도 성능. • 선형 - AVE.VE의 단순 선형 추가 • 선형 단위 - || *의 선형 추가 • VE와 ep의 cvx-볼록 조합. • 선형 표준 - X의 선형 추가 VE|| €0 || ||| VE||| 확산 생성 역 설계 장애물이 있는 램프 포함 이중 모드 멀티 도구 환경 크기 1x1x1x1x1x 롤아웃 길이 초기 유체 상자 왼쪽 0.오른쪽 0.아래쪽 0.위쪽 0.0.0.0.25, 0.0.0.0.35, 0.0.0.0.0.0.0.0.0.0.0.0.보상 샘플링 상자 왼쪽 0.0.0.0.25, 0.오른쪽 0.1.0.0.35, 0.아래쪽 0.0.0.0.위쪽 0.0.0.0.보상 o 0.0.0.0.PAPER 0.0.0.0.0.# 도구# 조인트 각도 설계 매개변수 조인트 각도, 이동(선택 사항) 조인트 각도조인트 각도, 이동조인트 각도, 이동 이동 도구 위치(왼쪽) [0.15, 0.35] [0.15, 0.35] [0.25, 0.35] [0.3, 0.6] [0.15-0.2, 0.35-0.4] 도구 길이 0.0.0.0.0. 추가 장애물 - 컵과 유체 사이의 중간 지점에 있는 장벽, 목표 주변의 컵 표 1. 작업 매개변수.
